<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Preceptor’s Primer for Bayesian Data Science: Using the Cardinal Virtues for Inference - 2&nbsp; Probability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-one-parameter.html" rel="next">
<link href="./04-rubin-causal-model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-probability.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Preceptor’s Primer for Bayesian Data Science: Using the Cardinal Virtues for Inference</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/PPBDS/primer/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Preceptor-s-Primer-for-Bayesian-Data-Science--Using-the-Cardinal-Virtues-for-Inference.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Preceptor-s-Primer-for-Bayesian-Data-Science--Using-the-Cardinal-Virtues-for-Inference.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preamble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preamble</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-rubin-causal-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Rubin Causal Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-probability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-one-parameter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">One Parameter</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-two-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Two Parameters</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-three-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Three Parameters</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-four-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Four Parameters</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-five-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Five Parameters</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-n-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">N Parameters</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Key Concepts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./set-up.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Set Up for Working on The Primer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./style-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Style Guide</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-distributions" id="toc-sec-distributions" class="nav-link active" data-scroll-target="#sec-distributions"><span class="header-section-number">2.1</span> Distributions</a>
  <ul class="collapse">
  <li><a href="#scaling-distributions" id="toc-scaling-distributions" class="nav-link" data-scroll-target="#scaling-distributions"><span class="header-section-number">2.1.1</span> Scaling distributions</a></li>
  <li><a href="#normalizing-distributions" id="toc-normalizing-distributions" class="nav-link" data-scroll-target="#normalizing-distributions"><span class="header-section-number">2.1.2</span> Normalizing distributions</a></li>
  <li><a href="#simulating-distributions" id="toc-simulating-distributions" class="nav-link" data-scroll-target="#simulating-distributions"><span class="header-section-number">2.1.3</span> Simulating distributions</a></li>
  </ul></li>
  <li><a href="#probability-distributions" id="toc-probability-distributions" class="nav-link" data-scroll-target="#probability-distributions"><span class="header-section-number">2.2</span> Probability distributions</a>
  <ul class="collapse">
  <li><a href="#flipping-a-coin" id="toc-flipping-a-coin" class="nav-link" data-scroll-target="#flipping-a-coin"><span class="header-section-number">2.2.1</span> Flipping a coin</a></li>
  <li><a href="#rolling-two-dice" id="toc-rolling-two-dice" class="nav-link" data-scroll-target="#rolling-two-dice"><span class="header-section-number">2.2.2</span> Rolling two dice</a></li>
  <li><a href="#presidential-elections" id="toc-presidential-elections" class="nav-link" data-scroll-target="#presidential-elections"><span class="header-section-number">2.2.3</span> Presidential elections</a></li>
  <li><a href="#height" id="toc-height" class="nav-link" data-scroll-target="#height"><span class="header-section-number">2.2.4</span> Height</a></li>
  <li><a href="#joint-distributions" id="toc-joint-distributions" class="nav-link" data-scroll-target="#joint-distributions"><span class="header-section-number">2.2.5</span> Joint distributions</a></li>
  <li><a href="#conditional-distrubutions" id="toc-conditional-distrubutions" class="nav-link" data-scroll-target="#conditional-distrubutions"><span class="header-section-number">2.2.6</span> Conditional distrubutions</a></li>
  </ul></li>
  <li><a href="#sec-rlist-columns-and-map-functions" id="toc-sec-rlist-columns-and-map-functions" class="nav-link" data-scroll-target="#sec-rlist-columns-and-map-functions"><span class="header-section-number">2.3</span> List-columns and map functions</a></li>
  <li><a href="#two-models" id="toc-two-models" class="nav-link" data-scroll-target="#two-models"><span class="header-section-number">2.4</span> Two models</a></li>
  <li><a href="#three-models" id="toc-three-models" class="nav-link" data-scroll-target="#three-models"><span class="header-section-number">2.5</span> Three models</a></li>
  <li><a href="#sec-n-models" id="toc-sec-n-models" class="nav-link" data-scroll-target="#sec-n-models"><span class="header-section-number">2.6</span> N models</a></li>
  <li><a href="#working-with-probability-distributions" id="toc-working-with-probability-distributions" class="nav-link" data-scroll-target="#working-with-probability-distributions"><span class="header-section-number">2.7</span> Working with probability distributions</a>
  <ul class="collapse">
  <li><a href="#random-variables" id="toc-random-variables" class="nav-link" data-scroll-target="#random-variables"><span class="header-section-number">2.7.1</span> Random variables</a></li>
  <li><a href="#rbinom" id="toc-rbinom" class="nav-link" data-scroll-target="#rbinom"><span class="header-section-number">2.7.2</span> <code>rbinom()</code></a></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="header-section-number">2.7.3</span> Summary statistics</a></li>
  </ul></li>
  <li><a href="#cardinal-virtues" id="toc-cardinal-virtues" class="nav-link" data-scroll-target="#cardinal-virtues"><span class="header-section-number">2.8</span> Cardinal Virtues</a>
  <ul class="collapse">
  <li><a href="#wisdom" id="toc-wisdom" class="nav-link" data-scroll-target="#wisdom"><span class="header-section-number">2.8.1</span> Wisdom</a></li>
  <li><a href="#justice" id="toc-justice" class="nav-link" data-scroll-target="#justice"><span class="header-section-number">2.8.2</span> Justice</a></li>
  <li><a href="#courage" id="toc-courage" class="nav-link" data-scroll-target="#courage"><span class="header-section-number">2.8.3</span> Courage</a></li>
  <li><a href="#temperance" id="toc-temperance" class="nav-link" data-scroll-target="#temperance"><span class="header-section-number">2.8.4</span> Temperance</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">2.9</span> Summary</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/PPBDS/primer/edit/main/05-probability.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-probability" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- Our previous approach used library(rgl). Instead of render_snapshot(), it had rglwiget() followed by something like close3d() to close the object. This created a 3d plot that could be manipulated, i.e., rotated with the pointer. It was cool! But was it really that useful? Anyway, that approach now causes an error which I could not solve. So, we switched to render_snapshot(), which works but with images that are fixed.  -->
<!-- Perhaps change the joint and conditional distribution section to use gender/height from NHANES? It is true that this is a discrete and continuous joint distribution, but that is probably fine. Certainly connects nicely with the male height example. Certainly works well with the joint and conditional together. Certainly would be nice to do the empirical/mathematical/posterior trypycht as in the first three examples. Posterior could be for a WNBA practice session. Most of the women will be tall, but the men will be of more typical height. -->
<!-- Shouldn't we have a question which we anwer with a dgm for each distribution example, as we do with three heads in a row? -->
<!-- Should we discuss more the interplay of the use of data and math? For example, in the Presidential election example, we recognize that the (naive) mathematical distribution is inconsistent with the data. So, we need to change the math. And then see if the new math is more consistent with the data. Perhaps an important point worth repeating. -->
<!-- Need more clarity on when/whether a distribution is empirical, meaning it is a histogram of the whole population (or a sample from it), and when it is an expection, like what we expect to happen if we sample one more person. Not even sure that this distinction is sensible . . . -->
<!-- Remove last couple of sloppy uses of group_by(). -->
<!-- Major change is that each example needs to have a simple question. Then it needs a DGM. Then we use the DGM to answer the question.  -->
<!-- In the list column section, is using a dot the best approach to working with map* functions and list-columns? Isn't there something new, with _ being a cool symbol for this? -->

<!-- Topics we don't currently address in the chapter but which we might add: population, Preceptor Table, Population Table. -->
<!-- How do we introduce the Question? We certainly need a question each time because, once we have the model, we have to show readers how to "work with" the distribution, and that requires a question to answer. Revisit this sentence: "All data science problems". -->
<!-- If A and B are independent, you can make a draw from the joint distribution of A and B --- p(A, B) --- by first taking a draw from A and combining it with a draw from B. Maybe this means discussing independence in the section of joint distributions? -->
<!-- The way that one does does so, is one draws 4,000 values from them, does some manipulation *row-by_row*, and then, hooray, you have you answer.  -->
<!-- You can consider these pdfs to be independent, so you can draw them independently and then --- this is the magic! --- you can treat a row as a draw from their joint distribution. -->
<!-- The joint distribution of a collection of random variables --- which we are working with by considering 4,000 draws from their pdfs --- is  . . . . the same as picking a random value from each member of the collection.  -->
<!-- There are two kinds of questions. The first asks for the value of a specific "real" number, like the height of the tallest person out of a 100. We answer this type of question with a posterior probability distribution. The second asks for the chances/likelihood/probability/odds of something --- like what are the chances that the tallest person will be above 200 cm. We answer this by first making a probability distribution and then calculating the appropriate area under the curve. -->
<!-- What would be a fun theme/gif/movie clip to start and end the chapter with, like we do in chapters 4 and 6? Something having to do with betting . . . Connected to Kant? -->
<!-- Add, after N models, a section on Infinite models, meaning a continuous parameter p. Note that we have a continuous distribution section now. Want to set the stage for Chapter 6, in which we are generating a posterior for p which we may think of as taking an infinite number of values. This is a key dimension on which chapter 5 and 6 need to connect. -->
<!-- Revisit these references and see if there is other stuff we should include. Rethinking marbles would make a nice tutorial. -->
<!-- Teaching Bayes' Rule: A Data-Oriented Approach by Jim Albert. -->
<!-- Rethinking Chapter 2. Garden of forking data is just excellent stuff. -->
<!-- Bayesian Workshop -->
<!-- Get rid of list-columns stuff? -->
<!-- Kant quote is OK, but not great. Would be nicer to start and end with a video, as in Chapters 4 and 6. -->
<!-- Consider how we might better connect the two model, three model, n model sections to the distribution sections. In all those cases, we are setting up a joint distribution and then marginalizing it (?) to create a conditional distribution, which looks a lot like a simple one dimensional distribution. -->
<blockquote class="blockquote">
<p>The usual touchstone of whether what someone asserts is mere persuasion or at least a subjective conviction, i.e., firm belief, is betting. Often someone pronounces his propositions with such confident and inflexible defiance that he seems to have entirely laid aside all concern for error. A bet disconcerts him. Sometimes he reveals that he is persuaded enough for one ducat but not for ten. For he would happily bet one, but at ten he suddenly becomes aware of what he had not previously noticed, namely that it is quite possible that he has erred. -— Immanuel Kant, <em>Critique of Pure Reason</em></p>
</blockquote>
<p>The central tension, and opportunity, in data science is the interplay between the <em>data</em> and the <em>science</em>, between our empirical observations and the models which we use to understand them. Probability is the language we use to explore that interplay; it connects models to data, and data to models.</p>
<p>What does it mean that Donald Trump had a <em>30% chance</em> of winning election in the fall of 2016? That there is a <em>90% probability</em> of rain tomorrow? That the dice at the casino are <em>fair</em>?</p>
<p>Probability quantifies uncertainty. Think of <em>probability</em> as a proportion. The probability of an event occurring is a number from 0 to 1, where 0 means that the event is impossible and 1 means that the event is 100% certain.</p>
<p>Begin with the simplest events: coin flips and dice rolls. The set of all outcomes is the <em>sample space</em>. With fair coins and dice, we know that:</p>
<ul>
<li>The probability of rolling a 1 or a 2 is 2/6, or 1/3.</li>
<li>The probability of rolling a 1, 2, 3, 4, 5, or 6 is 1.<br>
</li>
<li>The probability of flipping a coin and getting tails is 1/2.</li>
</ul>
<p>If the probability of an outcome is unknown, we will often refer to it as an unknown <em>parameter</em>, something which we might use data to <em>estimate</em>. We usually use Greek letters to refer to parameters. Whenever we are talking about a specific probability (represented by a single value), we will use <span class="math inline">\(\rho\)</span> (the Greek letter “rho” but spoken aloud as “p” by us) with a <em>subscript</em> which specifies the exact outcome of which it is the probability. For instance, <span class="math inline">\(\rho_h = 0.5\)</span> denotes the probability of getting heads on a coin toss when the coin is fair. <span class="math inline">\(\rho_t\)</span> — spoken as “PT” or “P sub T” or “P tails” — denotes the probability of getting tails on a coin toss. This notation can become annoying if the outcome whose probability we seek is less concise. For example, we might write the probability of rolling a 1, 2 or 3 using a fair six-sided dice as:</p>
<p><span class="math display">\[
\rho_{dice\ roll\ is\ 1,\ 2\ or\ 3} = 0.5
\]</span></p>
<p>We will rarely write out the full definition of an event along with the <span class="math inline">\(\rho\)</span> symbol. The syntax is just too ugly. Instead, we will define an event <em>a</em> as the case when one rolled dice equals 1, 2 or 3 and, then, write</p>
<p><span class="math display">\[\rho_a = 0.5\]</span></p>
<p>A <em>random variable</em> is a function which produces a value from a sample set. A random variable can be either discrete — where the sample set has a limited number of members, like H or T for the result of a coin flip, or 2, 3, …, 12 for the sum of two dice — or continuous (any value within a range). Probability is a claim about the value of a random variable, i.e., that you have a 50% probability of getting a 1, 2 or 3 when you roll a fair dice.</p>
<p>We usually use capital letters for random variables. So, <span class="math inline">\(C\)</span> might be our symbol for the random variable which is a coin toss and <span class="math inline">\(D\)</span> might be our symbol for the random variable which is the sum of two dice. When discussing random variables in general, or when we grow tired of coming up with new symbols, we will use <span class="math inline">\(Y\)</span>.</p>
<p>Small letters refer to a single outcome or result from a random variable. <span class="math inline">\(c\)</span> is the outcome from one coin toss. <span class="math inline">\(d\)</span> is the result from one throw of the dice. The value of the outcome must come from the sample space. So, <span class="math inline">\(c\)</span> can only take on two possible values: heads or tails. When discussing random variables in general, we use <span class="math inline">\(y\)</span> to refer to one outcome of the random variable <span class="math inline">\(Y\)</span>. If there are multiple outcomes — if we have, for example, flipped the coin multiple times — then we use subscripts to indicate the separate outcomes: <span class="math inline">\(y_1\)</span>, <span class="math inline">\(y_2\)</span>, and so on. The symbol for an arbitrary outcome is <span class="math inline">\(y_i\)</span>, where <span class="math inline">\(i\)</span> ranges from 1 through <span class="math inline">\(N\)</span>, the total number of events or experiments for which an outcome <span class="math inline">\(y\)</span> was produced.</p>
<p>The only package we need in this chapter is <strong>tidyverse</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To understand probability more fully, we first need to understand distributions.</p>
<section id="sec-distributions" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-distributions"><span class="header-section-number">2.1</span> Distributions</h2>
<p>A variable in a tibble is a column, a vector of values. We sometimes refer to this vector as a “distribution.” This is somewhat sloppy in that a distribution can be many things, most commonly a mathematical formula. But, strictly speaking, a “frequency distribution” or an “empirical distribution” is a list of values, so this usage is not unreasonable.</p>
<section id="scaling-distributions" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="scaling-distributions"><span class="header-section-number">2.1.1</span> Scaling distributions</h3>
<p>Consider the vector which is the result of rolling one dice 10 times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ten_rolls <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are other ways of storing the data in this vector. Instead of reporting every observation, we could record the number of times each value appears or the percentage of the total which this number accounts for.</p>
<div class="cell">
<div class="cell-output-display">

<div id="ubaxqbnngh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ubaxqbnngh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ubaxqbnngh thead, #ubaxqbnngh tbody, #ubaxqbnngh tfoot, #ubaxqbnngh tr, #ubaxqbnngh td, #ubaxqbnngh th {
  border-style: none;
}

#ubaxqbnngh p {
  margin: 0;
  padding: 0;
}

#ubaxqbnngh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ubaxqbnngh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ubaxqbnngh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ubaxqbnngh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ubaxqbnngh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ubaxqbnngh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubaxqbnngh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ubaxqbnngh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ubaxqbnngh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ubaxqbnngh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ubaxqbnngh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ubaxqbnngh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ubaxqbnngh .gt_spanner_row {
  border-bottom-style: hidden;
}

#ubaxqbnngh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ubaxqbnngh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ubaxqbnngh .gt_from_md > :first-child {
  margin-top: 0;
}

#ubaxqbnngh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ubaxqbnngh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ubaxqbnngh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ubaxqbnngh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ubaxqbnngh .gt_row_group_first td {
  border-top-width: 2px;
}

#ubaxqbnngh .gt_row_group_first th {
  border-top-width: 2px;
}

#ubaxqbnngh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubaxqbnngh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ubaxqbnngh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ubaxqbnngh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubaxqbnngh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubaxqbnngh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ubaxqbnngh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ubaxqbnngh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ubaxqbnngh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubaxqbnngh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ubaxqbnngh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubaxqbnngh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ubaxqbnngh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubaxqbnngh .gt_left {
  text-align: left;
}

#ubaxqbnngh .gt_center {
  text-align: center;
}

#ubaxqbnngh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ubaxqbnngh .gt_font_normal {
  font-weight: normal;
}

#ubaxqbnngh .gt_font_bold {
  font-weight: bold;
}

#ubaxqbnngh .gt_font_italic {
  font-style: italic;
}

#ubaxqbnngh .gt_super {
  font-size: 65%;
}

#ubaxqbnngh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ubaxqbnngh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ubaxqbnngh .gt_indent_1 {
  text-indent: 5px;
}

#ubaxqbnngh .gt_indent_2 {
  text-indent: 10px;
}

#ubaxqbnngh .gt_indent_3 {
  text-indent: 15px;
}

#ubaxqbnngh .gt_indent_4 {
  text-indent: 20px;
}

#ubaxqbnngh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="3" class="gt_heading gt_title gt_font_normal" style="">Distribution of Ten Rolls of a Fair Dice</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Counts and percentages reflect the same information</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Outcome">Outcome</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Percentage">Percentage</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="outcome" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">2</td>
<td headers="portion" class="gt_row gt_right">0.2</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">2</td>
<td headers="n" class="gt_row gt_right">2</td>
<td headers="portion" class="gt_row gt_right">0.2</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">4</td>
<td headers="n" class="gt_row gt_right">1</td>
<td headers="portion" class="gt_row gt_right">0.1</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">5</td>
<td headers="n" class="gt_row gt_right">4</td>
<td headers="portion" class="gt_row gt_right">0.4</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">6</td>
<td headers="n" class="gt_row gt_right">1</td>
<td headers="portion" class="gt_row gt_right">0.1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>In this case, with only 10 values, it is actually less efficient to store the data like this. But what happens when we have 1,000 rolls?</p>
<div class="cell">
<div class="cell-output-display">

<div id="qvuxyhcywz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qvuxyhcywz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qvuxyhcywz thead, #qvuxyhcywz tbody, #qvuxyhcywz tfoot, #qvuxyhcywz tr, #qvuxyhcywz td, #qvuxyhcywz th {
  border-style: none;
}

#qvuxyhcywz p {
  margin: 0;
  padding: 0;
}

#qvuxyhcywz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qvuxyhcywz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qvuxyhcywz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qvuxyhcywz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qvuxyhcywz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvuxyhcywz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvuxyhcywz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvuxyhcywz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qvuxyhcywz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qvuxyhcywz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qvuxyhcywz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qvuxyhcywz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qvuxyhcywz .gt_spanner_row {
  border-bottom-style: hidden;
}

#qvuxyhcywz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qvuxyhcywz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qvuxyhcywz .gt_from_md > :first-child {
  margin-top: 0;
}

#qvuxyhcywz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qvuxyhcywz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qvuxyhcywz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qvuxyhcywz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qvuxyhcywz .gt_row_group_first td {
  border-top-width: 2px;
}

#qvuxyhcywz .gt_row_group_first th {
  border-top-width: 2px;
}

#qvuxyhcywz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvuxyhcywz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qvuxyhcywz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qvuxyhcywz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvuxyhcywz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvuxyhcywz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qvuxyhcywz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qvuxyhcywz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qvuxyhcywz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvuxyhcywz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvuxyhcywz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvuxyhcywz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvuxyhcywz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvuxyhcywz .gt_left {
  text-align: left;
}

#qvuxyhcywz .gt_center {
  text-align: center;
}

#qvuxyhcywz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qvuxyhcywz .gt_font_normal {
  font-weight: normal;
}

#qvuxyhcywz .gt_font_bold {
  font-weight: bold;
}

#qvuxyhcywz .gt_font_italic {
  font-style: italic;
}

#qvuxyhcywz .gt_super {
  font-size: 65%;
}

#qvuxyhcywz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qvuxyhcywz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qvuxyhcywz .gt_indent_1 {
  text-indent: 5px;
}

#qvuxyhcywz .gt_indent_2 {
  text-indent: 10px;
}

#qvuxyhcywz .gt_indent_3 {
  text-indent: 15px;
}

#qvuxyhcywz .gt_indent_4 {
  text-indent: 20px;
}

#qvuxyhcywz .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="3" class="gt_heading gt_title gt_font_normal" style="">Distribution of One Thousand Rolls of a Fair Dice</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Counts and percentages reflect the same information</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Outcome">Outcome</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Count">Count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Percentage">Percentage</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="outcome" class="gt_row gt_right">1</td>
<td headers="n" class="gt_row gt_right">190</td>
<td headers="portion" class="gt_row gt_right">0.190</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">2</td>
<td headers="n" class="gt_row gt_right">138</td>
<td headers="portion" class="gt_row gt_right">0.138</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">3</td>
<td headers="n" class="gt_row gt_right">160</td>
<td headers="portion" class="gt_row gt_right">0.160</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">4</td>
<td headers="n" class="gt_row gt_right">173</td>
<td headers="portion" class="gt_row gt_right">0.173</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">5</td>
<td headers="n" class="gt_row gt_right">169</td>
<td headers="portion" class="gt_row gt_right">0.169</td></tr>
    <tr><td headers="outcome" class="gt_row gt_right">6</td>
<td headers="n" class="gt_row gt_right">170</td>
<td headers="portion" class="gt_row gt_right">0.170</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Instead of keeping around a vector of length 1,000, we can just keep 12 values — the 6 possible outcomes and their frequency — without losing any information.</p>
<p>Two distributions can be identical even if they are of very different lengths. Let’s compare our original distribution of 10 rolls of the dice with another distribution which just features 100 copies of those 10 rolls.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>more_rolls <span class="ot">&lt;-</span> <span class="fu">rep</span>(ten_rolls, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The two graphs have the exact same shape because, even though the vectors are of different lengths, the relative proportions of the outcomes are identical. In some sense, both vectors are from the same distribution. <em>Relative proportions, not the total counts, are what matter.</em></p>
</section>
<section id="normalizing-distributions" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="normalizing-distributions"><span class="header-section-number">2.1.2</span> Normalizing distributions</h3>
<p>If two distributions have the same shape, then they only differ by the labels on the y-axis. There are various ways of “normalizing” distributions so as to place them all the same scale. The most common scale is one in which the area under the distribution adds to 1, e.g., 100%. For example, we can transform the above plots:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We sometimes refer to a distribution as “unnormalized” if the area under the curve does not add up to 1.</p>
</section>
<section id="simulating-distributions" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="simulating-distributions"><span class="header-section-number">2.1.3</span> Simulating distributions</h3>
<p><em>There are two distinct concepts: a distribution and a set values drawn from that distribution.</em> But, in typical usage, we employ “distribution” for both. When given a distribution (meaning a vector of numbers), we often use <code>geom_histogram()</code> or <code>geom_density()</code> to display it. But, sometimes, we don’t want to look at the whole thing. We just want some summary measures which report the key aspects of the distribution. The two most important attributes of a distribution are its <em>center</em> and its <em>variation</em> around that center.</p>
<!-- DK: Awk paragraph. -->
<p>We use <code>summarize()</code> to calculate statistics for a variable, a column, a vector of values, or a distribution. Note the language sloppiness. For the purposes of this book, “variable,” “column,” “vector,” and “distribution” all mean the same thing. Other popular statistical functions include: <code>mean()</code>, <code>median()</code>, <code>min()</code>, <code>max()</code>, <code>n()</code> and <code>sum()</code>. Functions which may be new to you include three measures of the “spread” of a distribution: <code>sd()</code> (the standard deviation), <code>mad()</code> (the scaled median absolute deviation) and <code>quantile()</code>, which is used to calculate an <em>interval</em> which includes a specified proportion of the values.</p>
<!-- *A distribution is a function that shows the possible values of a variable and how often they occur.* DK: I like this! But where to include it? -->
<p>Think of the distribution of a variable as an urn from which we can pull out, at random, values for that variable. Drawing a thousand or so values from that urn, and then looking at a histogram, can show where the values are centered and how they vary. Because people are sloppy, they will use the word distribution to refer to at least three related entities:</p>
<ol type="1">
<li>the (imaginary!) urn from which we are drawing values.</li>
<li>all the values in the urn</li>
<li>all the values which we have drawn from the urn, whether that be 10 or 1,000</li>
</ol>
<p>Sloppiness in the usage of the word distribution is universal. However, keep three distinct ideas separate:</p>
<ul>
<li><p>The <em>unknown true distribution</em> which, in reality, generates the data which we see. Outside of stylized examples in which we <em>assume</em> that a distribution follows a simple mathematical formula, we will never have access to the unknown true distribution. We can only estimate it. This unknown true distribution is often referred to as the <em>data generating mechanism</em>, or DGM. It is a function or black box or urn which produces data. We can see the data. We can’t see the urn.</p></li>
<li><p>The <em>estimated distribution</em> which, we think, generates the data which we see. Again, we can never know the unknown true distribution. But, by making some assumptions and using the data we have, we can <em>estimate</em> a distribution. Our estimate may be very close to the true distribution. Or it may be far away. The main task of data science to to create and use these estimated distributions. Almost always, these distributions are instantiated in computer code. Just as there is a <em>true</em> data generating mechanism associated with the (unknown) <em>true</em> distribution, there is an <em>estimated</em> data generating mechanism associated with the <em>estimated</em> ditribution.</p></li>
<li><p>A <em>vector of numbers drawn</em> from the estimated distribution. Both true and estimated distributions can be complex animals, difficult to describe accurately and in detail. But a vector of numbers drawn from a distribution is easy to understand and use. So, in general, we work with vectors of numbers. When someone — either a colleague or a piece of R code — creates a distribution which we want to use to answer a question, we don’t really want the distribution itself. Rather, we want a vectors of “draws” from that distribution. Vectors are easy to work with! Complex computer code is not.</p></li>
</ul>
<p>Again, people (including us!) will often be sloppy and use the same word, “distribution,” without making it clear whether they are talking about the <em>true distribution</em>, the <em>estimated distribution</em>, or a vector of <em>draws</em> from the estimated distribution. The same sloppiness applies to the use of the term <em>data generating mechanism</em>. Try not to be sloppy.</p>
<p>Much of the rest of the <em>Primer</em> involves learning how to work with distributions, which generally means working with the draws from those distributions. Fortunately, the usual rules of arithmetic apply. You can add/subtract/multiply/divide distributions by working with draws from those distributions, just as you can add/subtract/multiply/divide regular numbers.</p>
<!-- Also need to talk more about working with distributions, especially calculating areas under the curve. Maybe do this under each example below. -->
</section>
</section>
<section id="probability-distributions" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="probability-distributions"><span class="header-section-number">2.2</span> Probability distributions</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-probability/images/de_finetti.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Bruno de Finetti, an Italian statistician who wrote a famous treatise on the theory of probability that began with the statement “PROBABILITY DOES NOT EXIST.”</figcaption>
</figure>
</div>
</div>
</div>
<p>For the purposes of this <em>Primer</em>, a <em>probability distribution</em> is a mathematical object which maps a set of outcomes to probabilities, where each distinct outcome has a chance of occurring between 0 and 1 inclusive. The probabilities must sum to 1. The set of possible outcomes, i.e., the sample space — heads or tails for the coin, 1 through 6 for a single dice, 2 through 12 for the sum of a pair of dice — can be either discrete or continuous. Remember, discrete data can only take on certain values. Continuous data, like height and weight, can take any value within a range. The set of outcomes is the <em>domain</em> of the probability distribution. The <em>range</em> is the associated probabilities.</p>
<p>Assume that a probability distribution is created by a <em>probability function</em>, a set function which maps outcomes to probabilities. The concept of a “probability function” is often split into two categories: probability <em>mass</em> functions (for discrete random variables) and probability <em>density</em> functions (for continuous random variables). As usual, we will be a bit sloppy, using the term probability distribution for both the mapping itself and for the function which creates the mapping.</p>
<p>We discuss three types of probability distributions: <em>empirical</em>, <em>mathematical</em>, and <em>posterior</em>.</p>
<p>The key difference between a <em>distribution</em>, as we have explored them in <a href="#sec-distributions"><span>Section&nbsp;2.1</span></a>, and a <em>probability</em> distribution is the requirement that the sum of the probabilities of the individual outcomes must be exactly 1. There is no such requirement for a distribution in general. But any distribution can be turned into a probability distribution by “normalizing” it. In this context, we will often refer to a distribution which is not (yet) a probability distribution as an “unnormalized” distribution.</p>
<!-- DK: Should we be using the symbol rho and then speaking "PT"? Need to look at how we discuss things later in the book, and then set the stage for that here. -->
<p>Pay attention to notation. Recall that when we are talking about a specific probability (represented by a single value), we will use <span class="math inline">\(\rho\)</span> (the Greek letter “rho”) with a <em>subscript</em> which specifies the exact outcome of which it is the probability. For instance, <span class="math inline">\(\rho_h = 0.5\)</span> denotes the probability of getting heads on a coin toss when the coin is fair. <span class="math inline">\(\rho_t\)</span> — spoken as “PT” or “P sub T” or “P tails” — denotes the probability of getting tails on a coin toss. However, when we are referring to the entire probability distribution over a set of outcomes, we will use <span class="math inline">\(P()\)</span>. For example, the probability distribution of a coin toss is <span class="math inline">\(P(\text{coin})\)</span>. That is, <span class="math inline">\(P(\text{coin})\)</span> is composed of the two specific probabilities (50% and 50%) mapped from the two values in the domain (Heads and Tails). Similarly, <span class="math inline">\(P(\text{sum of two dice})\)</span> is the probability distribution over the set of 11 outcomes (2 through 12) which are possible when you take the sum of two dice. <span class="math inline">\(P(\text{sum of two dice})\)</span> is made up of 11 numbers — <span class="math inline">\(\rho_2\)</span>, <span class="math inline">\(\rho_3\)</span>, …, <span class="math inline">\(\rho_{12}\)</span> — each representing the unknown probability that the sum will equal their value. That is, <span class="math inline">\(\rho_2\)</span> is the probability of rolling a 2.</p>
<section id="flipping-a-coin" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="flipping-a-coin"><span class="header-section-number">2.2.1</span> Flipping a coin</h3>
<p>Data science problems start with a question. Example:</p>
<p><em>What are the chances of getting three heads in a row when flipping a fair coin?</em></p>
<p>Questions are answered with the help of probability distributions.</p>
<p>An <em>empirical distribution</em> is based on data. Think of this as the probability distribution created by collecting data in the real world or by running a simulation on your computer. In theory, if we increase the number of coins we flip (either in reality or via simulation), the empirical distribution will look more and more similar to the mathematical distribution. The mathematical distribution is the Platonic form. The empirical distribution will often look like the mathematical probability distribution, but it will rarely be exactly the same.</p>
<p>In this simulation, there are 44 heads and 56 tails. The outcome will vary every time we run the simulation, but the proportion of heads to tails should not be too different if the coin is fair.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A <em>mathematical distribution</em> is based on a mathematical formula. Assuming that the coin is perfectly fair, we should, on average, get heads as often as we get tails.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The distribution of a single observation is described by this formula.</p>
<p><span class="math display">\[ P(Y = y) = \begin{cases} 1/2 &amp;\text{for }y= \text{Heads}\\ 1/2 &amp;\text{for }y= \text{Tails} \end{cases}\]</span> We sometimes do not know that the probability of heads and the probability of tails both equal 50%. In that case, we might write:</p>
<p><span class="math display">\[ P(Y = y) = \begin{cases} \rho_H &amp;\text{for }y= \text{Heads}\\ \rho_T &amp;\text{for }y= \text{Tails} \end{cases}\]</span></p>
<p>Yet, we know that, by definition, <span class="math inline">\(\rho_H + \rho_T = 1\)</span>, so we can rewrite the above as:</p>
<p><span class="math display">\[ P(Y = y) = \begin{cases} \rho_H &amp;\text{for }y= \text{Heads}\\ 1- \rho_H &amp;\text{for }y= \text{Tails} \end{cases}\]</span></p>
<p>Coin flipping (and related scenarios with only two possible outcomes) are such common problems, that the notation is often simplified further, with <span class="math inline">\(\rho\)</span> understood, by convention, to be the probability of heads. In that case, we can write the mathematical distribution is two canonical forms:</p>
<p><span class="math display">\[P(Y) = Bernoulli(\rho)\]</span> and</p>
<p><span class="math display">\[y_i \sim Bernoulli(\rho)\]</span> All five of these versions mean the same thing! The first four describe the mathematical probability distribution for a fair coin. The capital <span class="math inline">\(Y\)</span> within the <span class="math inline">\(P()\)</span> indicates a random variable. The fifth highlights one “draw” from that random variable, hence the lower case <span class="math inline">\(y\)</span> and the subscript <span class="math inline">\(i\)</span>.</p>
<p>Most probability distributions do not have special names, which is why we will use the generic symbol <span class="math inline">\(P\)</span> to refer to them. But some common probability distributions do have names, like “Bernoulli” in this case.</p>
<p>If the mathematical assumptions are correct, then, as your sample size increases, the empirical probability distribution will look more and more like the mathematical distribution.</p>
<p>A <em>posterior distribution</em> is based on beliefs and expectations. It displays your beliefs about things you can’t see right now. You may have posterior distributions for outcomes in the past, present, or future.</p>
<p>In the case of the coin toss, the posterior distribution changes depending on your beliefs. For instance, let’s say your friend brought a coin to school and asked to bet you. If the result is heads, you have to pay them $5. In that case, your posterior probability distribution might look like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The fact that your friend wants to bet on heads suggests to you that the coin is not fair. Does it <em>prove</em> that the coin is unfair? No! Much depends on the sort of person you think your friend is. <em>Your</em> posterior probability distribution is <em>your</em> opinion, based on <em>your</em> experiences and beliefs. <em>My</em> posterior probability distribution will often be (very) different from yours.</p>
<p>The full terminology is mathematical (or empirical or posterior) <em>probability</em> distribution. But we will often shorten this to just mathematical (or empirical or posterior) distribution. The word “probability” is understood, even if it is not present.</p>
<!-- DK: Not sure I like this. Maybe use `rbinom(n = 10, size = 13, prob = 0.5)` instead? Maybe show both? -->
<p>Recall the question with which we started this section: <em>What are the chances of getting three heads in a row when flipping a fair coin?</em> To answer this question, we need to use a probability distribution as our <em>data generating mechanism</em>. Fortunately, the <code>rbinom()</code> function allows us to generate the results for coin flips. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 0 1 1 0 0 0 0 0</code></pre>
</div>
</div>
<p>generates the results of 10 coin flips, where a result of heads is presented as <code>1</code> and tails as <code>0</code>. With this tool, we can generate 1,000 draws from our experiment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">toss_1 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">toss_2 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">toss_3 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 × 3
   toss_1 toss_2 toss_3
    &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
 1      0      1      1
 2      0      1      1
 3      0      1      0
 4      0      0      1
 5      1      1      0
 6      1      0      1
 7      1      0      0
 8      1      0      1
 9      0      0      1
10      0      1      1
# ℹ 990 more rows</code></pre>
</div>
</div>
<p>Because the flips are independent, we can consider each row to be a draw from the experiment. Then, we simply count up the proportion of experiments in which resulted in three heads.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">toss_1 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">toss_2 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">toss_3 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">three_heads =</span> toss_1 <span class="sc">+</span> toss_2 <span class="sc">+</span> toss_3 <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">chance =</span> <span class="fu">mean</span>(three_heads))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  chance
   &lt;dbl&gt;
1  0.104</code></pre>
</div>
</div>
<p>This is close to the “correct” answer of <span class="math inline">\(1/8\)</span>th. If we increase the number of draws, we will get closer to the “truth.” The reason for the quotation marks around “correct” and “truth” is that we are uncertain. We don’t know the <em>true</em> probability distribution for this coin. If this coin is a trick coin — like the one we expect our friend to have brought to school — then the odds of three heads in a row would be much higher:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">toss_1 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.95</span>),</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">toss_2 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.95</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">toss_3 =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.95</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">three_heads =</span> toss_1 <span class="sc">+</span> toss_2 <span class="sc">+</span> toss_3 <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">chance =</span> <span class="fu">mean</span>(three_heads))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  chance
   &lt;dbl&gt;
1   0.87</code></pre>
</div>
</div>
<p>This is our first example of using a <em>data generating mechanism</em> — meaning <code>rbinom()</code> — to answer a question. We will see many more in the chapters to come.</p>
</section>
<section id="rolling-two-dice" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="rolling-two-dice"><span class="header-section-number">2.2.2</span> Rolling two dice</h3>
<p>Data science begins with a question:</p>
<p><em>What is the probability of rolling a 7 or an 11 with a pair of dice?</em></p>
<p>We get an <em>empirical distribution</em> by rolling two dice a hundred times, either by hand or with a computer simulation. The result is not identical to the mathematical distribution because of the inherent randomness of the real world and/or of simulation.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We might consider labeling the y-axis in plots of empirical distributions as “Proportion” rather than “Probability” since it is an actual proportion, calculated from real (or simulated) data. We will keep it as “Probability” since we want to emphasize the parallels between mathematical, empirical and posterior probability distributions.</p>
<p>Our <em>mathematical distribution</em> tells us that, with a fair dice, the probability of getting 1, 2, 3, 4, 5, and 6 are equal: there is a 1/6 chance of each. When we roll two dice at the same time and sum the numbers, the values closest to the middle are more common than values at the edge because there are more combinations of numbers that add up to the middle values.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><span class="math display">\[ P(Y = y) = \begin{cases} \dfrac{y-1}{36} &amp;\text{for }y=1,2,3,4,5,6 \\ \dfrac{13-y}{36} &amp;\text{for }y=7,8,9,10,11,12 \\ 0 &amp;\text{otherwise} \end{cases} \]</span></p>
<p>The <em>posterior distribution</em> for rolling two dice a hundred times depends on your beliefs. If you take the dice from your Monopoly set, you have reason to believe that the assumptions underlying the mathematical distribution are true. However, if you walk into a crooked casino and a host asks you to play craps, you might be suspicious, just as in the coin flip example above. The word “suspicious” means that you suspect that the data generating mechanism for these dice is not like that for honest dice. For example, in craps, a “come-out” roll of 7 and 11 is a “natural,” resulting in a win for the “shooter” and a loss for the casino. You might expect those numbers to occur less often than they would with fair dice. Meanwhile, a come-out roll of 2, 3 or 12 is a loss for the shooter. You might also expect values like 2, 3 and 12 to occur more frequently. Your posterior distribution might look like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Someone less suspicious of the casino would have a posterior distribution which looks more like the mathematical distribution.</p>
<p>We began this section with a question about the probability (or odds) of rolling a 7 or 11 — i.e., a “natural” — with a pair of dice. The answer to the question depends on whether or not we think the dice are fair. In other words, we need to know which distribution to use to answer the question.</p>
<p>Assume that the dice are fair. In that case, we can create a data generating mechanism by hand. (Alas, there is not a built-in R function for dice like there is for coin flips with <code>rbinom()</code>.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a variable like rolls makes our code easier to read and modify. Of</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># course, we could just hard code the 4 into the size argument for each of the</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># two calls to sample, but that is much less convenient.</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>rolls <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The details of the code matter. If we don't have replace = TRUE, sample will</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># only use each of the 6 possible values once. That might be OK if we are just</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># rolling the dice 4 times, but it won't work for thousands of rolls.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">dice_1 =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> rolls, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">dice_2 =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> rolls, <span class="at">replace =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result =</span> dice_1 <span class="sc">+</span> dice_2) <span class="sc">|&gt;</span> </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">natural =</span> <span class="fu">ifelse</span>(result <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  dice_1 dice_2 result natural
   &lt;int&gt;  &lt;int&gt;  &lt;int&gt; &lt;lgl&gt;  
1      2      2      4 FALSE  
2      3      6      9 FALSE  
3      4      3      7 TRUE   
4      2      6      8 FALSE  </code></pre>
</div>
</div>
<p>This code is another <em>data generating mechanism</em> or <em>dgm</em>. It allows us to simulate the distribution of the results from rolling a pair of fair dice. To answer our question, we simply increase the number of rolls and calculate the proportion of rolls which result in a 7 or 11.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rolls <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We probably don't need 100,000 rolls, but this code is so fast that it does</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># not matter. Generally 1,000 (or even 100) draws from the data generating</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mechanism is enough for most practical purposes.</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">dice_1 =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> rolls, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">dice_2 =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> rolls, <span class="at">replace =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result =</span> dice_1 <span class="sc">+</span> dice_2) <span class="sc">|&gt;</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">natural_perc =</span> <span class="fu">mean</span>(result <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">11</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  natural_perc
         &lt;dbl&gt;
1        0.221</code></pre>
</div>
</div>
<p>The probability of rolling either a 7 or an 11 with a pair of fair dice is about 22%.</p>
</section>
<section id="presidential-elections" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="presidential-elections"><span class="header-section-number">2.2.3</span> Presidential elections</h3>
<p>Data science begins with a question:</p>
<p><em>What is the probability that the Democratic candidate will win the Presidential election?</em></p>
<p>Consider the probability distribution for a political event, like a presidential election. We want to know the probability that Democratic candidate wins X electoral votes, where X comes from the range of possible outcomes: 0 to 538. (The total number of electoral votes in US elections since 1964 is 538.)</p>
<!-- DK: Need to discuss why we are using data since 1964 but not before? -->
<p>The <em>empirical distribution</em> in this case would involve counting the number of electoral votes that the Democratic candidate won in each of the Presidential elections in the last 50 years or so. For the empirical distribution, we create a tibble with electoral vote results from past elections. Looking at elections since 1964, we can observe that the number of electoral votes that the Democratic candidate received in each election is different.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Given that we only have 15 observations, it is difficult to draw conclusions or make predictions based off of this empirical distribution. But “difficult” does not mean “impossible.” For example, if someone, more than a year before the election, offered to bet us 50/50 that the Democratic candidate was going to win more than 475 electoral votes, we would take the bet. After all, this outcome has only happened once in the last 15 elections, so a 50/50 bet seems like a great deal.</p>
<p>We can build a <em>mathematical distribution</em> for X which assumes that the chances of the Democratic candidate winning any given state’s electoral votes is 0.5 and that the results from each state are independent.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If our assumptions about this mathematical distribution are correct — they are not! — then, as the sample size increase, the empirical distribution should look more and more similar to our mathematical distribution.</p>
<p>However, the data from past elections is more than enough to demonstrate that the assumptions of our mathematical probability distribution do not work for electoral votes. The model assumes that the Democrats have a 50% chance of receiving each of the 538 votes. Just looking at the mathematical probability distribution, we can observe that receiving 13 or 17 or 486 votes out of 538 would be extreme and almost impossible if the mathematical model were accurate. However, our empirical distribution shows that such extreme outcomes are quite common. Presidential elections have resulted in much bigger victories or defeats than this mathematical distribution seems to allow for, thereby demonstrating that our assumptions are false.</p>
<p>The <em>posterior distribution</em> of electoral votes is a popular topic, and an area of strong disagreement, among data scientists. Consider this posterior from <em>FiveThirtyEight</em>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below is a posterior probability distribution from the FiveThirtyEight website for August 13, 2020. This was created using the same data as the above distribution, but is displayed differently. For each electoral result, the height of the bar represents the probability that a given event will occur. However, there are no labels on the y-axis telling us what the specific probability of each outcome is. And that is OK! The specific values are not that useful. If we removed the labels on our own y-axes, would it matter? Probably not. Anytime there are many possible outcomes — 539, in this case — we stop looking at specific outcomes and, instead, look at where most of the “mass” of the distribution lies.</p>
<div class="cell" data-caption="FiveThirtyEight Posterior from August 13, 2020">
<div class="cell-output-display">
<p><img src="05-probability/images/fivethirtyeight.png" class="img-fluid" width="682"></p>
</div>
</div>
<p>Below is the posterior probability distribution from <em>The Economist</em>, also from August 13, 2020. This looks confusing at first because they chose to combine the axes for Republican and Democratic electoral votes. <em>The Economist</em> was less optimistic, relative to <em>FiveThirtyEight</em>, about Trump’s chances in the election.</p>
<div class="cell" data-caption="Economist Posterior from August 13, 2020">
<div class="cell-output-display">
<p><img src="05-probability/images/economist_aug13.png" class="img-fluid" width="1161"></p>
</div>
</div>
<p>These two models, built by smart people using similar data sources, have reached fairly different conclusions. Data science is difficult! There is not one “right” answer. Real life is not a problem set.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-probability/images/538_versus_Economist.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Watch the makers of these two models throw shade at each other on Twitter! Eliot Morris is one of the primary authors of the Economist model. Nate Silver is in charge of 538. They don’t seem to be too impressed with each other’s work! More smack talk <a href="https://statmodeling.stat.columbia.edu/2020/08/31/more-on-that-fivethirtyeight-prediction-that-biden-might-only-get-42-of-the-vote-in-florida/">here</a> and <a href="https://statmodeling.stat.columbia.edu/2020/08/31/problem-of-the-between-state-correlations-in-the-fivethirtyeight-election-forecast/">here</a>.</figcaption>
</figure>
</div>
</div>
</div>
<p>There are many questions you could explore with posterior distributions. They can relate to the past, present, or future.</p>
<ul>
<li>Past: How many electoral votes would Hilary Clinton have won if she had picked a different VP?</li>
<li>Present: What are the total campaign donations from Harvard faculty?</li>
<li>Future: How many electoral votes will the Democratic candidate for president win in 2024?</li>
</ul>
<!-- Add a question and then use a dgm to answer it. -->
</section>
<section id="height" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="height"><span class="header-section-number">2.2.4</span> Height</h3>
<!-- DK: This section is poorly written, but at least it begins with a question. Alas, we don't answer it! -->
<p>Question: <em>What is the height of the next adult male we will meet?</em></p>
<p>The three examples above are all <em>discrete</em> probability distributions, meaning that the outcome variable can only take on a limited set of values. A coin flip has two outcomes. The sum of a pair of dice has 11 outcomes. The total electoral votes for the Democratic candidate has 539 possible outcomes. In the limit, we can also create <em>continuous</em> probability distributions which have an <em>infinite</em> number of possible outcomes. For example, the average height for an American male could be any real number between 0 inches and 100 inches. (Of course, an average value anywhere near 0 or 100 is absurd. The point is that the average could be 68.564, 68.5643, 68.56432 68.564327, or any real number.)</p>
<p>All the characteristics for discrete probability distributions which we reviewed above apply just as much to continuous probability distributions. For example, we can create mathematical, empirical and posterior probability distributions for continuous outcomes just as we did for discrete outcomes.</p>
<p>The <em>empirical distribution</em> involves using data from the National Health and Nutrition Examination Survey (NHANES).</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Mathematical distribution</em> is completely based on mathematical formula and assumptions, as in the coin flip example. In the coin-flip example, we assumed that the coin was perfectly fair, meaning that the probability of landing on heads or tails was equal. In this case, we make three assumptions. First, a male height follows a Normal distribution. Second, the average height of men is 175 cm. Third, the standard deviation for male height is 9 cm. We can create a Normal distribution using the <code>rnorm()</code> function with these two parameter values.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Again, the Normal distribution which is a probability distribution that is symmetric about the mean described by this formula.</p>
<p><span class="math display">\[y_i \sim N(\mu, \sigma^2)\]</span></p>
<!-- DK: Awk. -->
<p>Each value <span class="math inline">\(y_i\)</span> is drawn from a Normal distribution with parameters <span class="math inline">\(\mu\)</span> for the mean and <span class="math inline">\(\sigma\)</span> for the standard deviation. If the assumptions are correct, then, as our sample size increases, the empirical probability distribution will look more and more like the mathematical distribution.</p>
<p>The <em>posterior distribution</em> for heights depends on the context. Are we considering all the adult men in America? In that case, our posterior would probably look a lot like the empirical distribution using NHANES data. If we are being asked about the distribution of heights among players in the NBA, then our posterior might look like:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Caveats:</p>
<ul>
<li><p><em>Continuous variables are a myth.</em> Nothing that can be represented on a computer is <a href="https://cs.stackexchange.com/questions/71648/why-is-data-in-computer-science-considered-to-be-discrete">truly continuous</a>. Even something which appears continuous, like height, actually can only take on a (very large) set of discrete variables.</p></li>
<li><p>The math of continuous probability distributions can be tricky. Read <a href="https://drive.google.com/file/d/1VmkAAGOYCTORq1wxSQqy255qLJjTNvBI/view">a book</a> on mathematical probability for all the messy details. Little of that matters in applied work.</p></li>
<li><p>The most important difference is that, with discrete distributions, it makes sense to estimate the probability of a specific outcome. What is the probability of rolling a 9? With continuous distributions, this makes no sense because there are an infinite number of possible outcomes. <em>With continuous variables, we only estimate intervals.</em></p></li>
</ul>
<!-- DK: This is important. Give an example. Answer the question. -->
<p>Don’t worry about the distinctions between discrete and continuous outcomes, or between the discrete and continuous probability distributions which we will use to summarize our beliefs about those outcomes. The basic intuition is the same in both cases.</p>
</section>
<section id="joint-distributions" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="joint-distributions"><span class="header-section-number">2.2.5</span> Joint distributions</h3>
<!-- DK: Should be p(A). Discuss p(A, B). Find a better example.  -->
<p>Recall that <span class="math inline">\(P(\text{coin})\)</span> is the probability distribution for the result of a coin toss. It includes two parts, the probability of heads (<span class="math inline">\(\rho_h\)</span>) and the probability of tails (<span class="math inline">\(\rho_t\)</span>). This is a <em>univariate</em> distribution because there is only one outcome, which can be heads or tails. If there is more than one outcome, then we have a <em>joint</em> distribution.</p>
<!-- DK: Use of "outcome" is sloppy. Does a single dice roll have one outcome or 6? -->
<p>Joint distributions are also mathematical objects that cover a set of outcomes, where each distinct outcome has a chance of occurring between 0 and 1 and the sum of all chances must equal 1. The key to a joint distribution is that it measures the chance that both outcome <span class="math inline">\(a\)</span> from the set of events A <em>and</em> outcome <span class="math inline">\(b\)</span> from the set of events B will occur. The notation is <span class="math inline">\(P(A, B)\)</span>.</p>
<p>Let’s say that you are rolling two six-sided dice simultaneously. Dice 1 is weighted so that there is a 50% chance of rolling a 6 and a 10% chance of each of the other values. Dice 2 is weighted so there is a 50% chance of rolling a 5 and a 10% chance of rolling each of the other values. Let’s roll both dice 1,000 times. In previous examples involving two dice, we cared about the sum of results and not the outcomes of the first versus the second dice of each simulation. With a joint distributions, the outcomes for individual dice matter; so instead of 11 possible outcomes on the x-axis of our distribution plot (ranging from 2 to 12), we have 36 outcomes. Furthermore, a 2D probability distribution is not sufficient to represent all of the variables involved, so the joint distribution for this example is displayed using a 3D plot.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conditional-distrubutions" class="level3" data-number="2.2.6">
<h3 data-number="2.2.6" class="anchored" data-anchor-id="conditional-distrubutions"><span class="header-section-number">2.2.6</span> Conditional distrubutions</h3>
<p>Imagine that 60% of people in a community have a disease. A doctor develops a test to determine if a random person has the disease. However, this test isn’t 100% accurate. There is an 80% probability of correctly returning positive <strong>if the person has the disease</strong> and 90% probability of correctly returning negative <strong>if the person does not have the disease</strong>.</p>
<p>The probability of a random person having the disease is 0.6. Since each person either has the disease or doesn’t (those are the only two possibilities), the probability that a person does not have the disease is <span class="math inline">\(1 - 0.6 = 0.4\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability/images/tree-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>If a person has the disease, then we go up the top branch. The probability of an infected person testing positive is 0.8 because the test is 80% sure of correctly returning positive when the person has the disease.</p></li>
<li><p>By the same logic, if a person does not have the disease, we go down the bottom branch. The probability of the person incorrectly testing positive is 0.1.</p></li>
</ul>
<p>We decide to go down the top branch <em>if</em> our random person has the disease. We go down the bottom branch <em>if</em> they do not. This is <strong>conditional probability</strong>. The probability of testing positive is <strong>dependent</strong> on whether the person has the disease.</p>
<p>How would you express this in statistical notation? <span class="math inline">\(P(A|B)\)</span> is the same thing as the probability of A <em>given</em> B. <span class="math inline">\(P(A|B)\)</span> means the probability of A <em>if</em> we know for sure the value of B. Note that <span class="math inline">\(P(A|B)\)</span> is not the same thing as <span class="math inline">\(P(B|A)\)</span>.</p>
<p>There are three main categories of probability distributions: univariate, joint and condictional. <span class="math inline">\(p(A)\)</span> is the probability distribution for event A. This is a <em>univariate</em> probability distribution because there is only one random variable. <span class="math inline">\(p(A, B)\)</span> is the <em>joint</em> probability distribution of A and B. <span class="math inline">\(p(A | B)\)</span> is the conditional probability distribution of A given that B has taken on a specific value. This is often written as <span class="math inline">\(p(A | B = b)\)</span>.</p>
</section>
</section>
<section id="sec-rlist-columns-and-map-functions" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="sec-rlist-columns-and-map-functions"><span class="header-section-number">2.3</span> List-columns and map functions</h2>
<!-- Could we get rid of all of this? How useful is it to learn these tricks if we will just be using rstanarm and friends after Chapter 6? -->
<p>We need to expand our collection of R tricks by learning about list-columns and <code>map_*</code> functions. Recall that a list is different from an atomic vector. In atomic vectors, each element of the vector has one value. Lists, however, can contain vectors, and even more complex objects, as elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">9</span>), <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"Z"</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1]  4 16  9

[[2]]
[1] "A" "Z"</code></pre>
</div>
</div>
<p><code>x</code> is a list with two elements. The first element is a numeric vector of length 3. The second element is a character vector of length 2. We use <code>[[]]</code> to extract specific elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>x[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  4 16  9</code></pre>
</div>
</div>
<p>There are a number of built-in R functions that output lists. For example, <strong><em>ggplot</em></strong> objects store all of the plot information in a list. Any function that returns multiple values can be used to create a list output by wrapping that returned object with <code>list()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># range() returns the min and max of the argument </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.841155  1.098223</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can create a tibble which includes the results of range(x)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">col_1 =</span> <span class="fu">list</span>(<span class="fu">range</span>(x))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  col_1    
  &lt;list&gt;   
1 &lt;dbl [2]&gt;</code></pre>
</div>
</div>
<p>Notice this is a 1-by-1 tibble with one observation, which is a list of one element. Voila! You have just created a <strong>list-column</strong>.</p>
<p><em>If a function returns multiple values as a vector, like <code>range()</code> does, you must use <code>list()</code> as a wrapper if you want to create a list-column.</em></p>
<p>A list column is a column of your data which is a <a href="https://adv-r.hadley.nz/vectors-chap.html#lists">list</a> rather than an atomic vector. As with stand-alone list objects, you can pipe to <code>str()</code> to examine the column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble() is what we use to generate a tibble, it acts sort of like the</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate(), but mutate() needs a data frame to add new column, tibble can</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># survive on itself.</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">col_1 =</span> <span class="fu">list</span>(<span class="fu">range</span>(x))) <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1 × 1] (S3: tbl_df/tbl/data.frame)
 $ col_1:List of 1
  ..$ : num [1:2] -1.84 1.1</code></pre>
</div>
</div>
<p>We can use <code>map_*</code> functions to both create a list-column and then, much more importantly, work with that list-column afterwards.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># .x is col_1 from tibble and ~ sum(.) is the formula</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">col_1 =</span> <span class="fu">list</span>(<span class="fu">range</span>(x))) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_2 =</span> <span class="fu">map_dbl</span>(col_1, <span class="sc">~</span> <span class="fu">sum</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1 × 2] (S3: tbl_df/tbl/data.frame)
 $ col_1:List of 1
  ..$ : num [1:2] -1.84 1.1
 $ col_2: num -0.743</code></pre>
</div>
</div>
<p><code>map_*</code> functions, like <code>map_dbl()</code> in this example, take two key arguments, <code>.x</code> (the data which will be acted on) and <code>.f</code> (the function which will act on this data). Here, <code>.x</code> is the data in <code>col_1</code>, which is a list-column. <code>.f</code> is the function <code>sum()</code>. However, we can not simply write <code>map_dbl(col_1, sum)</code>. Instead, each use of <code>map_*</code> functions requires the use of a tilde — a <code>~</code> — to indicate the start of the function and the use of a dot — a <code>.</code> — to specify where the data goes in the function.</p>
<p><code>map_*</code> functions are a family of functions, with the suffix specifying the type of the object to be returned. <code>map()</code> itself returns a list. <code>map_dbl()</code> returns a double. <code>map_int()</code> returns an integer. <code>map_chr()</code> returns a character, and so on. Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">ID =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_1 =</span> <span class="fu">map</span>(ID, <span class="sc">~</span><span class="fu">range</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_2 =</span> <span class="fu">map_dbl</span>(col_1, <span class="sc">~</span> <span class="fu">sum</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_3 =</span> <span class="fu">map_int</span>(col_1, <span class="sc">~</span> <span class="fu">length</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_4 =</span> <span class="fu">map_chr</span>(col_1, <span class="sc">~</span> <span class="fu">sum</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `col_4 = map_chr(col_1, ~sum(.))`.
Caused by warning:
! Automatic coercion from double to character was deprecated in purrr 1.0.0.
ℹ Please use an explicit call to `as.character()` within `map_chr()` instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1 × 5] (S3: tbl_df/tbl/data.frame)
 $ ID   : num 1
 $ col_1:List of 1
  ..$ : num [1:2] -0.741 0.916
 $ col_2: num 0.176
 $ col_3: int 2
 $ col_4: chr "0.175759"</code></pre>
</div>
</div>
<p>Consider a more detailed example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This simple example demonstrates the workflow which we will often follow.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Start by creating a tibble which will be used to store the results. (Or start</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># with a tibble which already exists and to which you will be adding more</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># columns.) It is often convenient to get all the code working with just a few</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rows. Once it is working, we increase the number of rows to a thousand or</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># million or whatever we need.</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The big convenience is being able to store a list in each row of the tibble.</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that we are not using the value of ID in the call to rnorm(). (That is</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># why we don't have a "." anywhere.) But we are still using ID as a way of</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># iterating through each row; ID is keeping count for us, in a sense.</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draws =</span> <span class="fu">map</span>(ID, <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Each succeeding step of the pipe works with columns already in the tibble</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># while, in general, adding more columns. The next step calculates the max</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value in each of the draw vectors. We use map_dbl() because we know that</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># max() will returns a single number.</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">max =</span> <span class="fu">map_dbl</span>(draws, <span class="sc">~</span> <span class="fu">max</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We will often need to calculate more than one item from a given column like</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># draws. For example, in addition to knowing the max value, we would like to</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># know the range. Because the range is a vector, we need to store the result</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in a list column. map() does that for us automatically.</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">min_max =</span> <span class="fu">map</span>(draws, <span class="sc">~</span> <span class="fu">range</span>(.)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
     ID draws        max min_max  
  &lt;int&gt; &lt;list&gt;     &lt;dbl&gt; &lt;list&gt;   
1     1 &lt;dbl [10]&gt; 1.68  &lt;dbl [2]&gt;
2     2 &lt;dbl [10]&gt; 0.364 &lt;dbl [2]&gt;
3     3 &lt;dbl [10]&gt; 1.44  &lt;dbl [2]&gt;</code></pre>
</div>
</div>
<p>This flexibility is only possible via the use of list-columns and <code>map_*</code> functions. This workflow is extremely common. We start with an empty tibble, using ID to specify the number of rows. With that skeleton, each step of the pipe adds a new column, working off a column which already exists.</p>
</section>
<section id="two-models" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="two-models"><span class="header-section-number">2.4</span> Two models</h2>
<!-- Consider the parallel structure of the 2-model, 3-model, and n-model case. First, we  begin by discussing how to create the joint distribution of possible models and possible experimental results. This is done by, first, assuming that one of the models is true and then, second, show the variation in the world which results. That is, even if we know for a fact that you do not have the disease, there is still a chance that you test will come back positive.

 Then, we create the joint distribution by doing that same thing for all possible models. (We show all this code.) The joint distribution is a tibble which we are happy to look at. It always has two columns: the first is the possible models (have disease) and the second is one possible result (test_positive) if that model is true. And that each possible model have at least 1,000 rows in the joint distribution.. -->
<!-- Having create the joint distribution, we graph it in two dimensions. (We show the code for that.) Then, we graph it in three dimensions with rayshader. (We have a rough movie.) Then, we take a "slice" of that joint distribution via rayshader (Have the movie but needs improvement). Move that slice around. Et cetera. Not sure how to do all that . . . Note that you can make rayshader objects interactive with rgl::rglwidget(). The ggral (sp?) package might also be useful (Did not use ggral yet to create rayshader 3D). -->
<!-- After rayshader, we then use the joint distribution to make two graphics, showing the posterior distribution for the model. The first is unnormalized and the second is normalized. In both cases, we begin with the joint distribution --- an object we have saved --- and then use filter to get our slice. Both graph and unromalized and normalized were made in 2D, could considered using rayshader/movie. -->
<p>The simplest possible setting for inference involves two models — meaning two possible states of the world — and two outcomes from an experiment. Imagine that there is a disease — <em>Probophobia</em>, an irrational fear of probability — which you either have or don’t have. We don’t know if you have the diseases, but we do assume that there are only two possibilities.</p>
<p>We also have a test which is 99% accurate when given to a person who has <em>Probophobia</em>. Unfortunately, the test is only 50% accurate for people who do not have <em>Probophobia</em>. In this experiment, there only two possible outcomes: a positive and a negative result on the test.</p>
<p>Question: <em>If you test positive, what is the probability that you have Probophobia?</em></p>
<p>More generally, we are estimating a <em>conditional probability</em>. Conditional on the outcome of a postive test, what is the probability that you have Probophobia? Mathematically, we want:</p>
<p><span class="math display">\[ P(\text{Probophobia | Test = Postive} ) \]</span></p>
<p>To answer this question, we need to use the tools of joint and conditional probability from earlier in the Chapter. We begin by building, by hand, the joint distribution of the possible models (you have the Probophobia or you do not) and of the possible outcomes (you test positive or negative). Building the joint distribution involves <em>assuming</em> that each model is true and then creating the distribution of outcomes which might occur if that assumption is true.</p>
<p>For example, assume you have Probophobia. There is then a 50% chance that you test positive and a 50% chance you test negative. Similarly, if we assume that the second model is true — that you don’t have Probophobia — then there is 1% chance you test positive and a 99% you chance negative. Of course, for you (or any individual) we do not know for sure what is happening. We do not know if you have the disease. We do not know what your test will show. But we can use these relationships to construct the joint distribution.</p>
<!-- DK: Redo this analysis, and perhaps other similar examples below. First, column of tibble is the state of the world. Or list of all possible models. In this case, this would be `have_disease` which should be either TRUE or FALSE.  -->
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pipes generally start with tibbles, so we start with a tibble which just</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># includes an ID variable. We don't really use ID. It is just handy for getting</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># organized. We call this object `jd_disease`, where the `jd` stands for</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># joint distribution.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>jd_disease <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>sims, <span class="at">have_disease =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="dv">5000</span>)) <span class="sc">|&gt;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">positive_test =</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">if_else</span>(have_disease,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">map_int</span>(have_disease, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.99</span>)),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">map_int</span>(have_disease, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.5</span>))))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>jd_disease</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,000 × 3
      ID have_disease positive_test
   &lt;int&gt; &lt;lgl&gt;                &lt;int&gt;
 1     1 TRUE                     1
 2     2 FALSE                    1
 3     3 TRUE                     1
 4     4 FALSE                    1
 5     5 TRUE                     1
 6     6 FALSE                    0
 7     7 TRUE                     1
 8     8 FALSE                    1
 9     9 TRUE                     1
10    10 FALSE                    0
# ℹ 9,990 more rows</code></pre>
</div>
</div>
<p>The first step is to simply create an tibble that consists of the simulated data we need to plot our distribution. Keep in mind that in the setting we have two different probabilities and they are completely separate from each other and we want to keep the two probabilities and the disease results in two and only two columns so that we can graph using the <code>ggplot()</code> function. And that’s why we used the <code>rep</code> and <code>seq</code> functions when creating the table, we used the <code>seq</code> function to set the sequence we wants, in this case is only two numbers, 0.01 (99% accuracy for testing negative if no disease, therefore 1% for testing positive if no disease) and 0.5 (50% accuracy for testing positive/negative if have disease), then we used the <code>rep</code> functions to repeat the process 10,000 times for each probability, in total 20,000 times. Note that this number “20,000” also represent the number of observations in our simulated data, we simulated 20,000 results from testing, where 10,000 results from the have-disease group and 10,000 for the no-disease group, we often use the capital N to represent the population, in this simulated data <span class="math inline">\(N=20,000\)</span>.</p>
<p>Plot the joint distribution:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below is a joint distribution displayed in 3D. Instead of using the “jitter” feature in R to unstack the dots, we are using a 3D plot to visualize the number of dots in each box. The number of people who correctly test negative is far greater than of the other categories. The 3D plot shows the total number of cases for each section (True positive, True negative, False positive, False negative),the 3D bar coming from those combinations. Now,pay attention to the two rows of the 3D graph, if you trying to add up the length of the 3D bar for the top two sections and the bottom two sections, they should be equal to each other, where each have 10,000 case. This is because we simulate the experience in two independent and separate world one in the have-disease world and one in the no-disease world.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- DK: Insert the sliced rayshader distribution here, and discuss. Then, below, we do the same thing by hand. Then, use this text: -->
<!-- If we zoom in on the plot, FIX THIS people who tested positive have the disease and FIX THIS who tested positive do not have the disease. In this case, we are focusing on one slice of the probability distribution where the test result was positive. There are two disease outcomes: positive or negative. By isolating a section, we are looking at a conditional distribution. Conditional on a positive test, you can visualize the likelihood of actually having the disease versus not. -->
<p>This Section is called “Two Models” because, for each person, <em>there are two possible states of the world: have the disease or not have the disease.</em> By assumption, there are no other outcomes. We call these two possible states of the world “models,” even though they are very simple models.</p>
<p>In addition to the two models, we have two possible results of our experiment on a given person: test positive or test negative. Again, this is an assumption. We do not allow for any other outcome. In coming sections, we will look at more complex situations where we consider more than two models and more than two possible results of the experiment. In the meantime, we have built the <em>unnormalized joint distribution for models and results</em>. This is a key point! Look back earlier in this Chapter for discussions about both unnormalized distributions and joint distributions.</p>
<p>We want to analyze these plots by looking at different slices. For instance, let’s say that you have tested positive for the disease. Since the test is not always accurate, you cannot be 100% certain that you have it. We isolate the slice where the test result equals 1 (meaning positive).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>jd_disease <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(positive_test <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,484 × 3
      ID have_disease positive_test
   &lt;int&gt; &lt;lgl&gt;                &lt;int&gt;
 1     1 TRUE                     1
 2     2 FALSE                    1
 3     3 TRUE                     1
 4     4 FALSE                    1
 5     5 TRUE                     1
 6     7 TRUE                     1
 7     8 FALSE                    1
 8     9 TRUE                     1
 9    11 TRUE                     1
10    12 FALSE                    1
# ℹ 7,474 more rows</code></pre>
</div>
</div>
<p><strong>Most people who test positive are infected</strong> This is a result for common diseases like cold. We can easily create an unnormalized conditional distribution with:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em><code>filter()</code> transforms a joint distribution into a conditional distribution.</em></p>
<p>Turn this unnormalized distribution into a posterior probability distribution:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If we zoom in on the plot, about 70% of people who tested positive have the disease and 30% who tested positive do not have the disease. In this case, we are focusing on one slice of the probability distribution where the test result was positive. There are two disease outcomes: positive or negative. By isolating a section, we are looking at a conditional distribution. Conditional on a positive test, you can visualize the likelihood of actually having the disease versus not.</p>
<p>Now recalled the question we asked at the start of the session:</p>
<p><em>If you test positive, what is the probability that you have Probophobia?</em></p>
<p>By looking at the posterior graph we just create, we can answer this question easily:</p>
<p><em>With a positive test, you can be almost 70% sure that you have Probophobia, however there is a good chance about 30% that you receive a false positive, so don’t worry too much there is still about a third of hope that you get the wrong result</em></p>
<p>Now let’s consider the manipulation of this posterior, here is another question. Question : <em>10 people walks up to testing center, 5 of them tested negative, 5 of them tested positive, what is the probability of at least 6 people are actually healthy? </em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">test =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100000</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person1 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person2 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person3 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person4 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person5 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person6 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.7</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person7 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.7</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person8 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.7</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person9 =</span>  <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.7</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person10 =</span> <span class="fu">map_int</span>(test, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.7</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>test) <span class="sc">|&gt;</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The tricky part of this code is that we want to sum the outcomes across the</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rows of the tibble. This is different from our usual approach of summing</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># down the columns, as with summarize(). The way to do this is to, first, use</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rowwise() to tell R that we want to work with rows in the tibble and then,</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># second, use c_across() to indicate which variables we want to work with.</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(person1<span class="sc">:</span>person10))) <span class="sc">|&gt;</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(total)) <span class="sc">+</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count<span class="sc">/</span><span class="fu">sum</span>(count))),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- DK: Insert a use of this posterior? How many positive tests before you have at least 10 sick people? -->
</section>
<section id="three-models" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="three-models"><span class="header-section-number">2.5</span> Three models</h2>
<!-- DK: Should this be in terms of p or number of white marbles or both? -->
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability/images/marble.jpg" class="img-fluid" width="2144"></p>
</div>
</div>
<p>Imagine that your friend gives you a bag with two marbles. There could either be two white marbles, two black marbles, or one of each color. Thus, the bag could contain 0% white marbles, 50% white marbles, or 100% white marbles. The proportion, <span class="math inline">\(p\)</span>, of white marbles could be, respectively, 0, 0.5, or 1.</p>
<p>Question: <em>What is the chance of the bag contains exactly two white marbles, given that when we selected the marbles three times, every time we select a white marble?</em></p>
<p><span class="math display">\[ P(\text{2 White Marbles in bag | White Marbles Sampled = 3} ) \]</span> Just as during the <em>Probophobia</em> models, in order to answer this question, we need to start up with the simulated data and then graphing out the joint distribution of this scenerio because we need to considered all possible outcomes of this model, and then based on the joint distribution we can slice out the the part we want (the conditional distribution) in the end making a posterior graph as well as normalizing it to see the probability.</p>
<p>Step 1: Simulate the data into an tibble</p>
<p>Let’s say you take a marble out of the bag, record whether it’s black or white, then return it to the bag. You repeat this three times, observing the number of white marbles you see out of three trials. You could get three whites, two whites, one white, or zero whites as a result of this trial. We have three models (three different proportions of white marbles in the bag) and four possible experimental results. Let’s create 3,000 draws from this joint distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the joint distribution of the number of white marbles in the bag</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (in_bag) and the number of white marbles pulled out in the sample (in_sample),</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one-by-one. in_bag takes three possible values: 0, 1 and 2, corresponding to</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># zero, one and two white marbles potentially in the bag.</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We also start off with a tibble. It just makes things easier</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>jd_marbles <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>sims) <span class="sc">|&gt;</span> </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For each row, we (randomly!) determine the number of white marbles in the</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bag. We do not know why the `as.integer()` hack is necessary. Shouldn't</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `map_int()` automatically coerce the result of `sample()` into an integer?</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">in_bag =</span> <span class="fu">map_int</span>(ID, <span class="sc">~</span> <span class="fu">as.integer</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">size =</span> <span class="dv">1</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Depending on the number of white marbles in the bag, we randomly draw out 0,</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1, 2, or 3 white marbles in our experiment. We need `p = ./2` to transform</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the number of white marbles into the probability of drawing out a white</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># marble in a single draw. That probability is either 0%, 50% or 100%.</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">in_sample =</span> <span class="fu">map_int</span>(in_bag, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">p =</span> .<span class="sc">/</span><span class="dv">2</span>))) </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>jd_marbles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,000 × 3
      ID in_bag in_sample
   &lt;int&gt;  &lt;int&gt;     &lt;int&gt;
 1     1      0         0
 2     2      1         3
 3     3      2         3
 4     4      1         1
 5     5      2         3
 6     6      2         3
 7     7      1         0
 8     8      2         3
 9     9      0         0
10    10      1         2
# ℹ 9,990 more rows</code></pre>
</div>
</div>
<p>Step 2: Plot the joint distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The distribution is unnormalized. All we see is the number of outcomes in each</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># "bucket." Although it is never stated clearly, we are assuming that there is</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># an equal likelihood of 0, 1 or 2 white marbles in the bag.</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>jd_marbles <span class="sc">|&gt;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> in_sample, <span class="at">y =</span> in_bag)) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Black and White Marbles"</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"More white marbles in bag mean more white marbles selected"</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"White Marbles Selected"</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"White Marbles in the Bag"</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here is the 3D visualization:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The y-axes of both the scatterplot and the 3D visualization are labeled “Number of White Marbles in the Bag.” <em>Each value on the y-axis is a model, a belief about the world.</em> For instance, when the model is 0, we have no white marbles in the bag, meaning that none of the marbles we pull out in the sample will be white.</p>
<p>Now recalls the question, we essentially only care about the fourth column in the joint distribution (x-axis=3) because the question is asking us to create a conditional distribution <em>given</em> that fact that 3 marbles were selected. Therefore, we could isolate the slice where the result of the simulation involves three white marbles and zero black ones. Here is the unnormalized probability distribution.</p>
<p>Step 3: Plot the unnormalized conditional distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The key step is the filter. Creating a conditional distribution from a joint</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution is the same thing as filtering that joint distribution for a</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specific value. A conditional distribution is a "slice" of the joint</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution, and we take that slice with filter().</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>jd_marbles <span class="sc">|&gt;</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(in_sample <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(in_bag)) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Unnormalized Conditional Distribution"</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Number of white marbles in bag given that three were selected in the sample"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Number of White Marbles in the Bag"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Step 4: Plot the normalize posterior distribution. Next, let’s normalize the distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>jd_marbles <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(in_sample <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(in_bag)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count<span class="sc">/</span><span class="fu">sum</span>(count))), </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth =</span> <span class="fl">0.5</span>, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Probability Distribution"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Number of white marbles in bag given that three were selected in the sample"</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Number of White Marbles in the Bag"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                         scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot makes sense because when all three marbles you draw out of the bag are white, there is a pretty good chance that there are no black marbles in the bag. But you can’t be certain! It is possible to draw three white even if the bag contains one white and one black. However, it is impossible that there are zero white marbles in the bag.</p>
<p>Lastly let’s answer the question: <em>What is the chance of the bag contains exactly two white marbles, given that when we selected the white marbles three times, everytime we select a white marble?</em></p>
<p>Answer: <em>As the Posterior Probability Distribution shows (x-axis=2), the chance of the bag contains exactly two white marbles given that we select 3 white marbles out of three tries is about 85%.</em></p>
</section>
<section id="sec-n-models" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="sec-n-models"><span class="header-section-number">2.6</span> N models</h2>
<!-- 5 a) Now go on to Rethinking approach. I think that chapter 2 is just genius. Bayesian is really just counting. Maybe we do a very similar example to what he does? Maybe different? I am still pondering this myself. I think that there is a deep relationship here. In the simple Bayes rule decision trees, we know all the probabilities. But what if we don't? Instead, we get to observe lots of data (which are counts!) and then, from that data, figure out the probabilities. (Note that Rethinking does not talk like this --- after all, we know all the probabilities since each marble has a 20% chance of being drawn --- but I think it is implicit in his approach.) Key issue: Can we connect this in a sensible way to Bayesian scatterplot. There is always the data and the model and the relationship between the two. (And "the model" means, mainly, the parameter estimates thereof.) Tell me the data, and I will tell you the model. Tell me the model, and I will tell you the model. -->
<!-- Note the connection between the marbles from Rethinking and the Bayesian scatterplot. In figure 2.2 in Rethinking represents the model where p = 0.25, where p is the proportion of blue marbles in the total collection. The y-axis models would be labeled with p = 0, 0.25, 0.5, 0.75, and 1. With the tree marble diagram in figure 2.2, we would be taking random samples with 3 marbles. The number of blue marbles we get each time would be plotted along p = 0.25. This is another example of model on the y-axis and data on the x-axis. -->
<!-- DK: Should we cut out p = 0 and p = 1 as too annoying to deal with? -->
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability/images/heads.jpg" class="img-fluid" width="3000"></p>
</div>
</div>
<p>Assume that there is a coin with <span class="math inline">\(\rho_h\)</span>. We guarantee that there are only 11 possible values of <span class="math inline">\(\rho_h\)</span>: <span class="math inline">\(0, 0.1, 0.2, ..., 0.9, 1\)</span>. In other words, there are 11 possible models, 11 things which might be true about the world. This is just like situations we have previously discussed, except that there are more models to consider.</p>
<p>We are going to run an experiment in which you flip the coin 20 times and record the number of heads. What does this result tell you about the value of <span class="math inline">\(\rho_h\)</span>? Ultimately, we will want to calculate a posterior distribution of <span class="math inline">\(\rho_h\)</span>, which is written as p(<span class="math inline">\(\rho_h\)</span>).</p>
<p>Question: <em>What is the probability of getting exactly 8 heads out of 20 tosses?</em></p>
<p>To start, it is useful to consider all the things which might happen if, for example, <span class="math inline">\(\rho_h = 0.4\)</span>. Fortunately, the R functions for simulating random variables makes this easy.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>First, notice that many different things can happen! Even if we <em>know</em>, for certain, that <span class="math inline">\(\rho_h = 0.4\)</span>, many outcomes are possible. Life is remarkably random. Second, the most likely result of the experiment is 8 heads, as we would expect. Third, we have transformed the raw counts of how many times each total appeared into a probability distribution. Sometimes, however, it is convenient to just keep track of the raw counts. The shape of the figure is the same in both cases.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Either way, the figures show what would have happened if that model — that <span class="math inline">\(\rho_h = 0.4\)</span> — were true.</p>
<p>We can do the same thing for all 11 possible models, calculating what would happen if each of them were true. This is somewhat counterfactual since only one of them can be true. Yet this assumption does allow us to create the <em>joint distribution</em> of <em>models which might be true</em> and of <em>data which our experiment might generate</em>. Let’s simplify this is p(models, data), although you should keep the precise meaning in mind.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here is the 3D version of the same plot.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In both of these diagrams, we see 11 models and 21 outcomes. We don’t really care about the p(<span class="math inline">\(models\)</span>, <span class="math inline">\(data\)</span>), the joint distribution of the models-which-might-be-true and the data-which-our-experiment-might-generate. Instead, we want to estimate <span class="math inline">\(p\)</span>, the unknown parameter which determines the probability that this coin will come up heads when tossed. The joint distribution alone can’t tell us that. We <em>created</em> the joint distribution before we had even conducted the experiment. It is our creation, a tool which we use to make inferences. Instead, we want the conditional distribution, p(<span class="math inline">\(models\)</span> | <span class="math inline">\(data = 8\)</span>). We have the results of the experiment. What do those results tell us about the probability distribution of <span class="math inline">\(p\)</span>?</p>
<p>To answer this question, we simply take a vertical <em>slice</em> from the joint distribution at the point of the x-axis corresponding to the results of the experiment.</p>
<p>This animation shows what we want to do with joint distributions. We take a slice (the red one), isolate it, rotate it to look at the conditional distribution, normalize it (change the values along the current z-axis from counts to probabilities), then observe the resulting posterior.</p>
<!-- 

TW: I tried to recreate the GIF below in rayshader, but failed. For those bold enough to try, the process 
to create it would be as follows (problem described at the end):


1. Create a dataframe with three columns: x, y and z. These will be the coordinates. 
   Note that you need to cover every possible combination of x and y-values, and 
   every such combination must have a z-value. Thus, the dataframe should have 
   3 * [(#x-values)*(#values)] observations. Creating this by hand is a tedious process, 
   but if you are using the same series of z-values over and over again, MS Excel might 
   be helpful. 
   If you want to save time, check out the file Values.xlsx in primer/05-probability. It
   contains a dataframe I created, but it does not have the exact same dimensions as the plot 
   in the GIF.
   
   
2. Create a 2D plot like this and and save it as an object.
    
plot <-- ggplot(df, aes(x, y, color = z)) +
          geom_point() +
          theme(legend.position = "none")
   
   
3. Turn it into a 3D plot. Use the following code. Only the first
   argument is required, you may adjust the rest.

plot_gg(plot,
        width = 3.5,
        zoom = 0.65,
        theta = 25,
        phi = 30,
        sunangle = 225,
        soliddepth = -50,
        windowsize = c(2048,1536))


4. If you installed xquartz, and window named "RGL Device" with the plot 
   should have opened on your machine. Tilt the plot in the desired position.
   Then, run this command to create a snapshot:
   
render_snapshot()

   Congrats, you now have a single snapshot. However, keep in mind that in order to 
   create a GIF, you need a series of snapshots that can be rendered into a GIF. This
   means you will have to repeat the above process for every possible perspective/plot 
   seen in below. And since the GIF consist of different plots, you must not only change
   the perspective, but also the plot itself when creating all those snapshots. As I see it, 
   there are four different plots that would need to be created:
    
    - "edge view" and all blue (initial view / one snapshot)
    - "edge view" and one distribution red (one snapshot)
    - "edge view" and all but red distribution flat (one snapshot) 
    - shift to a frontal 2D-like perspective (many snapshots)
   
   The last step can (and should) be automated. This involves writing a loop that changes the 
   view on the plot just a little bit, creates a snapshot, moves on to the next position, creates
   another snapshot, and so on. This is not as hard as it seems, and a basic example of this can
   be found here https://www.tylermw.com/a-step-by-step-guide-to-making-3d-maps-with-satellite-imagery-in-r/
   (scroll down to the last image).
   

5. Once you have created all the snapshots the GIF will consist of, make sure their names reflect
   the order in which they should be displayed. For example, "plot1.png", "plot2.png" and so on. If
   you write the loop the right way, you may only have to rename the first three snapshots created 
   manually. See the link above for details.
   Finally, you can put it all together. First, run this command in R to close the "RGL Device" window:

rgl::rgl.close()

  Next, run this command in the TERMINAL. Make sure that you are in the right working directory and that 
  you have ffmpeg installed. The third part defines the framerate per second, the example below uses 60. 
  The fifth part must be named like your snapshots, followed by "%d.png". The last part is the name of the 
  mp4 file, or the GIF, and can be named anything you like.

system("ffmpeg -framerate 60 -i plot%d.png -pix_fmt yuv420p plot_gif.mp4")
   
   
-----------------------
   
The Problem:

I don't know how to create a 3D plot with rayshader and gpplot AND manually defined colors. Specifically, 
I didn't manage to create the 3D plot with one red distribution surrounded by blue distributions. The issue 
seems to be that rayshader uses the "color" aesthetic to make the z-axis. If you try to change the color of 
a range of observations to red/blue, the z-values of these observations will be messed up.  


-->
<p><img src="05-probability/animations/color_red_combo.gif" class="img-fluid"></p>
<p>This is the only part of the joint distribution that we care about. We aren’t interested in what the object looks like where, for example, the number of heads is 11. That portion is irrelevant because we observed 8 heads, not 11. By using the filter function on the simulation tibble we created, we can conclude that there are a total of 465 times in our simulation in which 8 heads were observed.</p>
<p>As we would expect, most of the time when 8 coin tosses came up heads, the value of <span class="math inline">\(p\)</span> was 0.4. But, on numerous occasions, it was not. It is quite common for a value of <span class="math inline">\(p\)</span> like 0.3 or 0.5 to generate 8 heads. Consider:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Yet this is a distribution of raw counts. It is an unnormalized density. To turn it into a proper probability density (i.e., one in which the sum of the probabilities across possible outcomes sums to one) we just divide everything by the total number of observations.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Solution:</p>
<p><em>The most likely value of <span class="math inline">\(\rho_h\)</span> is 0.4, as before. But, it is much more likely that <span class="math inline">\(p\)</span> is either 0.3 or 0.5. And there is about an 8% chance that <span class="math inline">\(\rho_h \ge 0.6\)</span>.</em></p>
<p>You might be wondering: what is the use of a model? Well, let’s say we toss the coin 20 times and get 8 heads again. Given this result, we can ask: <em>What is the probability that future samples of 20 flips will result in 10 or more heads?</em></p>
<p>There are three main ways you could go about solving this problem with simulations.</p>
<p>The first <em>wrong</em> way to do this is assuming that <span class="math inline">\(\rho_h\)</span> is certain because we observed 8 heads after 20 tosses. We would conclude that 8/20 gives us 0.4. The big problem with this is that you are ignoring your uncertainty when estimating <span class="math inline">\(\rho_h\)</span>. This would lead us to the following code.</p>
<div class="cell" data-hash="05-probability_cache/html/unnamed-chunk-61_4bdbd9e5b1c102b89a98b205f7c6cb39">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="dv">10000000</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sim_ID =</span> <span class="dv">1</span><span class="sc">:</span>sims) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heads =</span> <span class="fu">map_int</span>(sim_ID, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">p =</span> .<span class="dv">4</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">above_ten =</span> <span class="fu">if_else</span>(heads <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>odds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,000,000 × 3
   sim_ID heads above_ten
    &lt;int&gt; &lt;int&gt; &lt;lgl&gt;    
 1      1    10 TRUE     
 2      2     5 FALSE    
 3      3     2 FALSE    
 4      4    10 TRUE     
 5      5     5 FALSE    
 6      6    10 TRUE     
 7      7     7 FALSE    
 8      8    11 TRUE     
 9      9     9 FALSE    
10     10     9 FALSE    
# ℹ 9,999,990 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>odds <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>heads,<span class="at">fill=</span>above_ten))<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count<span class="sc">/</span><span class="fu">sum</span>(count))),<span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'grey50'</span>, <span class="st">'red'</span>))<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Probability Distribution (Wrong Way)"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Number of heads in 20 tosses"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Number of heads"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Probability"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Above ten heads"</span>) <span class="sc">+</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using this Posterior distribution derived from the (wrong way) simulated data, the probability results in 10 or more head is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>odds <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">success =</span> <span class="fu">sum</span>(above_ten)<span class="sc">/</span>sims)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  success
    &lt;dbl&gt;
1   0.245</code></pre>
</div>
</div>
<p>about 24.5%.</p>
<p>The second method involves sampling the whole posterior distribution vector we previously created. This would lead to the following correct code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p_draws <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="dv">1000</span>)) <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heads =</span> <span class="fu">map_int</span>(p, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">p =</span> .))) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heads <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>odds_2nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p =</span> <span class="fu">sample</span>(p_draws<span class="sc">$</span>p, <span class="at">size =</span> sims, <span class="at">replace =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">heads =</span> <span class="fu">map_int</span>(p, <span class="sc">~</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">p =</span> .))) <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">above_ten =</span> <span class="fu">if_else</span>(heads <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)) </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>odds_2nd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10,000,000 × 3
       p heads above_ten
   &lt;dbl&gt; &lt;int&gt; &lt;lgl&gt;    
 1   0.4     7 FALSE    
 2   0.3     8 FALSE    
 3   0.5    13 TRUE     
 4   0.4    10 TRUE     
 5   0.4     6 FALSE    
 6   0.5     8 FALSE    
 7   0.5     9 FALSE    
 8   0.5    12 TRUE     
 9   0.5    10 TRUE     
10   0.4     8 FALSE    
# ℹ 9,999,990 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>odds_2nd <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heads,<span class="at">fill =</span> above_ten))<span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count<span class="sc">/</span><span class="fu">sum</span>(count))),<span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'grey50'</span>, <span class="st">'red'</span>))<span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Probability Distribution (Right Way)"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Number of heads in 20 tosses"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Number of heads"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Probability"</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Above ten heads"</span>) <span class="sc">+</span> </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">number_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using this Posterior distribution derived from the (right way 1st) simulated data, the probability results in 10 or more head is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>odds_2nd <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">success =</span> <span class="fu">sum</span>(above_ten)<span class="sc">/</span>sims)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  success
    &lt;dbl&gt;
1   0.351</code></pre>
</div>
</div>
<p>about 32.8%</p>
<p>As you may have noticed, if you calculated the value using the first method, you would believe that getting 10 or more heads is less likely than it really is. If you were to run a casino based on these assumptions, you will lose all your money. It is very important to be careful about the assumptions you are making. We tossed a coin 20 times and got 8 heads. However, you would be wrong to assume that <span class="math inline">\(\rho_h\)</span> = 0.4 just based on this result.</p>
<!-- ## Testing is evil -->
<!-- Introduce concepts like the null model, testing, and p-values. Connect to permutation tests from chapter 3.  Side note quotation: "Amateurs test. Professionals summarize." Maybe we should pick an example in which the number of heads is low enough to provide some reasonable evidence against p = 0.5. -->
<!-- In some fields, it is common to want to test a specific hypothesis. Consider the hypothesis that the coin is fair, i.e., that $p = 0.5$. Does the data we have support or reject that hypothesis? (Be wary that $p$ is both used for the probability of a head and the $p$-value of a hypothesis test.) -->
<!-- Not really interested in that exact test except in toy scenarios. -->
<!-- Difference between 0.04 and 0.06 is rarely significant. And is hardly ever a good reason to decide X over Y. -->
<!-- Infinite models might be an infinite urn. What is the proportion p of red beads in the urn? Assume you are sampling 25 beads from the urn. What is posterior for p if your draw out 5 reds? Inifite models just means setting 100,000 (or some large number) possible values for p when creating the joint distribution.  -->
</section>
<section id="working-with-probability-distributions" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="working-with-probability-distributions"><span class="header-section-number">2.7</span> Working with probability distributions</h2>
<!-- DK: Does this really belong here? Maybe at the end? Maybe after Height example above? -->
<section id="random-variables" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="random-variables"><span class="header-section-number">2.7.1</span> Random variables</h3>
<section id="sample" class="level4" data-number="2.7.1.1">
<h4 data-number="2.7.1.1" class="anchored" data-anchor-id="sample"><span class="header-section-number">2.7.1.1</span> <code>sample()</code></h4>
<p>The most common distributions you will work with are <em>empirical</em> or <em>frequency</em> distributions, the values of <code>age</code> in the <code>trains</code> tibble, the values of <code>poverty</code> in the <code>kenya</code> tibble, and so on. But we can also create our own data by making “draws” from a distribution which we have concocted.</p>
<p>Consider the distribution of the possible values from rolling a fair die. We can use the <code>sample()</code> function to create draws from this distribution, meaning it will change (or sometimes stay the same) for every subsequent draw.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>die <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="at">x =</span> die, <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>This produces one “draw” from the distribution of the possible values of one roll of fair six-sided die.</p>
<p>Now, suppose we wanted to roll this die 10 times. One of the arguments of the <code>sample()</code> function is <code>replace</code>. We must specify it as <code>TRUE</code> if values can appear more than once. Since, when rolling a die 10 times, we expect that a value like 3 can appear more than once, we need to set <code>replace = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="at">x =</span> die, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 5 6 3 3 3 4 3 6 4 5</code></pre>
</div>
</div>
<p>In other words, rolling a 1 on the first roll should not preclude you from rolling a 1 on a later roll.</p>
<p>What if the die is not “fair,” meaning that some sides are more likely to appear than others? The final argument of the <code>sample()</code> function is the <code>prob</code> argument. It takes a vector (of the same length as the initial vector <code>x</code>) that contains all of the probabilities of selecting each one of the elements of <code>x</code>. Suppose that the probability of rolling a 1 was 0.5, and the probability of rolling any other value is 0.1. (These probabilities should sum to 1. If they don’t <code>sample()</code> will automatically re-scale them.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="at">x =</span> die, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 3 1 2 1 1 6 1 1</code></pre>
</div>
</div>
<!-- DK: Keep this big picture discussion? And after the plot? -->
<p><strong>Remember: There is no real data here.</strong> We have not actually rolled a die. We have just made some assumptions about what would happen if we were to roll a die. With those assumptions we have built an urn — a <em>data generating mechanism</em> — from which we can draw as many values as we like. Let’s roll the unfair die 10,000 times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">result =</span> <span class="fu">sample</span>(<span class="at">x =</span> die, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">size =</span> <span class="dv">10000</span>, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)))) <span class="sc">|&gt;</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result)) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Results of an Unfair Die"</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Result of One Roll"</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><code>sample()</code> is just one of many functions for creating draws — or, more colloquially, “drawing” — from a distribution. Three of the most important functions are: <code>runif()</code>, <code>rbinom()</code>, and <code>rnorm()</code>.</p>
</section>
<section id="runif" class="level4" data-number="2.7.1.2">
<h4 data-number="2.7.1.2" class="anchored" data-anchor-id="runif"><span class="header-section-number">2.7.1.2</span> <code>runif()</code></h4>
<p>Consider a “uniform” distribution. This is the case in which every outcome in the range of possible outcomes has the same chance of occurring. The function <code>runif()</code> (spoken as “r-unif”) enables us to draw from a uniform contribution. <code>runif()</code> has three arguments: <code>n</code>, <code>min</code>, and <code>max</code>. <code>runif()</code> will produce <code>n</code> draws from between <code>min</code> and <code>max</code>, with each value having an equal chance of occurring.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">min =</span> <span class="dv">4</span>, <span class="at">max =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 5.594800 4.981960 4.601993 5.738417 4.879622 5.155263 4.319479 5.627666
 [9] 4.800110 5.634794</code></pre>
</div>
</div>
<p>Mathematically, we would notate:</p>
<p><span class="math display">\[y_i \sim U(4, 6)\]</span></p>
<p>This means that the each value for <span class="math inline">\(y\)</span> is drawn from a uniform distribution between four and six.</p>
</section>
</section>
<section id="rbinom" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="rbinom"><span class="header-section-number">2.7.2</span> <code>rbinom()</code></h3>
<p>Consider binomial distribution, the case in which the probability of some Boolean variable (for instance success or failure) is calculated for repeated, independent trials. One common example would be the probability of flipping a coin and landing on heads. The function <code>rbinom()</code> allows us to draw from a binomial distribution. This function takes three arguments, <code>n</code>, <code>size</code>, and <code>prob</code>.</p>
<p><em><code>n</code> is the number of values we seek to draw. </em><code>size</code> is the number of trials for each <code>n</code>. *<code>prob</code> is the probability of success on each trial.</p>
<p>Suppose we wanted to flip a fair coin one time, and let landing on heads represent success.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span> , <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Do the same thing 100 times:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">heads =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heads)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flipping a Fair Coin 100 Times"</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Result"</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Tails"</span>, <span class="st">"Heads"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In our graph above, we use the function <code>scale_x_continuous()</code> because our x-axis variable is continuous, meaning it can take on any real values. The <code>breaks</code> argument to <code>scale_x_continuous()</code> converts our x-axis to having two different “tick marks”. There is a fairly even distribution of Tails and Heads. More draws would typically result in an even more equal split.</p>
<p>Randomness creates (inevitable) tension between distribution as a “thing” and distribution as a vector of draws from that thing. In this case, the vector of draws is not balanced between Tails and Heads. Yet, we “know” that it should be since the coin is, by definition, fair. In a sense, the mathematics require an even split. Yet, randomness means that the vector of draws will rarely match the mathematically “true” result. And that is OK! First, randomness is an intrinsic property of the real world. Second, we can make the effect of randomness be as small as we want by increasing the number of draws.</p>
<!-- DK: Could do a little example of that, showing the convergence to 50% as n increases. -->
<p>Suppose instead we wanted to simulate an unfair coin, where the probability of landing on Heads was 0.75 instead of 0.25.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">heads =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.75</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heads)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flipping a Fair Coin 100 Times"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Result"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Tails"</span>, <span class="st">"Heads"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The distribution — the imaginary urn — from which we draw the results of a coin flip for a fair coin is a different distribution — a different imaginary urn — from the distribution for a biased coin. In fact, there are an infinite number of distributions. <em>Yet as long as we can draw values from a distribution, we can work with it.</em> Mathematics:</p>
<p><span class="math display">\[y_i \sim B(n, p)\]</span></p>
<p>Each value for <span class="math inline">\(y\)</span> is drawn from a binomial distribution with parameters <span class="math inline">\(n\)</span> for the number of trials and <span class="math inline">\(p\)</span> for the probability of success.</p>
<p>Instead of each <code>n</code> consisting of a single trial, we could have situation in which we are, 10,000 times, flipping a coin 10 times and summing up, for each experiment, the number of heads. In that case:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">heads =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heads)) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Flipping a Fair Coin 10 Times"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Extreme results are possible with enough experiments"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Total Number of Heads in Ten Flips"</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-probability_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="sec-normal" class="level4" data-number="2.7.2.1">
<h4 data-number="2.7.2.1" class="anchored" data-anchor-id="sec-normal"><span class="header-section-number">2.7.2.1</span> <code>rnorm()</code></h4>
<p>The most important distribution is the <em>normal distribution</em>. Mathematics:</p>
<p><span class="math display">\[y_i \sim N(\mu, \sigma^2)\]</span></p>
<p>Each value <span class="math inline">\(y_i\)</span> is drawn from a normal distribution with parameters <span class="math inline">\(\mu\)</span> for the mean and <span class="math inline">\(\sigma\)</span> for the standard deviation.</p>
<p>This bell-shaped distribution is defined by two parameters: (1) the <em>mean</em> <span class="math inline">\(\mu\)</span> (spoken as “mu”) which locates the center of the distribution and (2) the <em>standard deviation</em> <span class="math inline">\(\sigma\)</span> (spoken as “sigma”) which determines the variation of values around that center. In the figure below, we plot three normal distributions where:</p>
<ol type="1">
<li>The solid normal curve has mean <span class="math inline">\(\mu = 5\)</span> &amp; standard deviation <span class="math inline">\(\sigma = 2\)</span>.</li>
<li>The dotted normal curve has mean <span class="math inline">\(\mu = 5\)</span> &amp; standard deviation <span class="math inline">\(\sigma = 5\)</span>.</li>
<li>The dashed normal curve has mean <span class="math inline">\(\mu = 15\)</span> &amp; standard deviation <span class="math inline">\(\sigma = 2\)</span>.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggrepel' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-probability_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Three normal distributions.</figcaption>
</figure>
</div>
</div>
</div>
<p>Notice how the solid and dotted line normal curves have the same center due to their common mean <span class="math inline">\(\mu\)</span> = 5. However, the dotted line normal curve is wider due to its larger standard deviation of <span class="math inline">\(\sigma = 5\)</span>. On the other hand, the solid and dashed line normal curves have the same variation due to their common standard deviation <span class="math inline">\(\sigma = 2\)</span>. However, they are centered at different locations.</p>
<p>When the mean <span class="math inline">\(\mu = 0\)</span> and the standard deviation <span class="math inline">\(\sigma = 1\)</span>, the normal distribution has a special name. It’s called the <em>standard normal distribution</em> or the <em><span class="math inline">\(z\)</span>-curve</em>.</p>
<p>Furthermore, if a variable follows a normal curve, there are <em>three rules of thumb</em> we can use:</p>
<ol type="1">
<li>68% of values will lie within <span class="math inline">\(\pm\)</span> 1 standard deviation of the mean.</li>
<li>95% of values will lie within <span class="math inline">\(\pm\)</span> 1.96 <span class="math inline">\(\approx\)</span> 2 standard deviations of the mean.</li>
<li>99.7% of values will lie within <span class="math inline">\(\pm\)</span> 3 standard deviations of the mean.</li>
</ol>
<p>Let’s illustrate this on a standard normal curve. The dashed lines are at -3, -1.96, -1, 0, 1, 1.96, and 3. These 7 lines cut up the x-axis into 8 segments. The areas under the normal curve for each of the 8 segments are marked and add up to 100%. For example:</p>
<ol type="1">
<li>The middle two segments represent the interval -1 to 1. The shaded area above this interval represents 34% + 34% = 68% of the area under the curve. In other words, 68% of values.</li>
<li>The middle four segments represent the interval -1.96 to 1.96. The shaded area above this interval represents 13.5% + 34% + 34% + 13.5% = 95% of the area under the curve. In other words, 95% of values.</li>
<li>The middle six segments represent the interval -3 to 3. The shaded area above this interval represents 2.35% + 13.5% + 34% + 34% + 13.5% + 2.35% = 99.7% of the area under the curve. In other words, 99.7% of values.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-probability_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Rules of thumb about areas under normal curves.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summary-statistics" class="level3" data-number="2.7.3">
<h3 data-number="2.7.3" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">2.7.3</span> Summary statistics</h3>
<p>A probability distribution is not always easy to work with. It is a complex object. And, in many contexts, we don’t really care about all that complexity. So, instead of providing the full probability distribution, we often just use a summary measure, a number or two or three which captures those aspects of the entire distribution which are relevant to the matter at hand. Let’s explore these issues using the 538 posterior probability distribution, as of August 13, 2020, for the number of electoral votes which will be won by Joe Biden. Here is a tibble with 1,000,000 draws from that distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>draws</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000,000 × 2
      ID electoral_votes
   &lt;int&gt;           &lt;int&gt;
 1     1             388
 2     2             474
 3     3             279
 4     4             400
 5     5             239
 6     6             364
 7     7             198
 8     8             319
 9     9             336
10    10             294
# ℹ 999,990 more rows</code></pre>
</div>
</div>
<p><em>A distribution and a sample of draws from that distribution are different things.</em> But, if you squint, they are sort of the same thing, at least for our purposes. For example, if you want to know the mean of the distribution, then the mean of the draws will be a fairly good estimate, especially if the number of draws is large enough.</p>
<!-- DK: Need more here. Connect to the discussion in Section 2.9 -->
<p>Recall how we can draw randomly from specified probability distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.95693552  0.18860245 -2.04561627  0.41344817  0.26100764  1.18315071
 [7]  0.07832782 -1.14338230 -0.98240598  1.88883159</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.30482858 0.08068409 0.65942947 0.86727544 0.54974073 0.20976843
 [7] 0.77876867 0.09990737 0.74968824 0.19082733</code></pre>
</div>
</div>
<p>The elements of these vectors are all “draws” from the specified probability distributions. In most applied situations, our tools will produce draws rather than summary objects. Fortunately, a vector of draws is very easy to work with. Start with summary statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recall mean, media, standard deviation and mad functions.</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>key_stats <span class="ot">&lt;-</span> draws <span class="sc">|&gt;</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mn =</span> <span class="fu">mean</span>(electoral_votes),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">md =</span> <span class="fu">median</span>(electoral_votes),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(electoral_votes),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mad =</span> <span class="fu">mad</span>(electoral_votes))</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>key_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
     mn    md    sd   mad
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  325.   326  86.9  101.</code></pre>
</div>
</div>
<p>Calculate a 95% interval directly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(draws<span class="sc">$</span>electoral_votes, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 2.5% 97.5% 
  172   483 </code></pre>
</div>
</div>
<p>Approximate the 95% interval in two ways:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(key_stats<span class="sc">$</span>mn <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> key_stats<span class="sc">$</span>sd, </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  key_stats<span class="sc">$</span>mn <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> key_stats<span class="sc">$</span>sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 151.5461 499.0198</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(key_stats<span class="sc">$</span>md <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> key_stats<span class="sc">$</span>mad, </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  key_stats<span class="sc">$</span>md <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> key_stats<span class="sc">$</span>mad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 124.3664 527.6336</code></pre>
</div>
</div>
<p>In this case, using the mean and standard deviation produces a 95% interval which is closer to the true interval. In other cases, the median and scaled median absolute deviation will do better. Either approximation is generally “good enough” for most work. But, if you need to know the exact 95% interval, you must use <code>quantile()</code>.</p>
</section>
</section>
<section id="cardinal-virtues" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="cardinal-virtues"><span class="header-section-number">2.8</span> Cardinal Virtues</h2>
<p>The four <a href="https://en.wikipedia.org/wiki/Cardinal_virtues">Cardinal Virtues</a> are Wisdom, Justice, Courage, and Temperance. Because data science is, ultimately, a moral act, we use these virtues to guide our work. Every data science project begins with a question.</p>
<ul>
<li><p><em>Wisdom</em> starts by creating the Preceptor Table. What data, if we had it, would allow us to answer our question easily? If the Preceptor Table has one outcome, then the model is <em>predictive</em>. If it has more than one (potential) outcome, then the model is <em>causal</em>. We then explore the data we have. You can never look too closely at your data. Key question: Are the data we have close enough to the data we want (i.e., the Preceptor Table) that we can consider both as coming from the same <em>population</em>? If not, we can’t proceed further. Key in making that decision is the assumption of <em>validity</em>. Do the columns in the Preceptor Table match the columns in the data?</p></li>
<li><p><em>Justice</em> starts with the Population Table – the data we want to have, the data which we actually have, and all the other data from that same <em>population</em>. Each row of the Population Table is defined by a unique Unit/Time combination. We explore three key issues about the Population Table. First, does the relationship among the variables demonstrate <em>stability</em>, meaning is the model stable across different time periods? Second, are the rows associated with the data <em>representative</em> of all the units which we might have had data for from that time period? Third, for causal models only, we consider <em>unconfoundedness</em>. Justice concludes by making an assumption about the <em>data generating mechanism</em>. Which general mathematical formula connects the outcome variable we are interested in with the other data that we have?</p></li>
<li><p><em>Courage</em> allows us to explore different models. Even though Justice has provided the basic mathematical structure of the model, we still need to decide which variables to include and to estimate the values of unknown parameters. We avoid hypothesis tests. We check our models for consistency with the data we have. We select one model.</p></li>
<li><p><em>Temperance</em> guides us in the use of the model we have created to answer the questions we began with. We create posteriors of <em>quantities of interest</em>. We should be modest in the claims we make. The posteriors we create are never the “truth.” The assumptions we made to create the model are never perfect. Yet decisions made with flawed posteriors are almost always better than decisions made without them.</p></li>
</ul>
<section id="wisdom" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="wisdom"><span class="header-section-number">2.8.1</span> Wisdom</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="other/images/Wisdom.jpg" class="img-fluid figure-img" width="1280"></p>
<figcaption class="figure-caption">Wisdom.</figcaption>
</figure>
</div>
</div>
</div>
<p>Wisdom helps us decide if we can even hope to answer our question with the data we have.</p>
<p>Begin with the Preceptor Table. What rows and columns of data do you need such that, if you had them all, the calculation of the <em>quantity of interest</em> would be trivial? If you want to know the average height of an adult in India, then the Preceptor Table would include a row for each adult and a column for their height. With no missing data, the average is easy to determine, as are a wide variety of other <em>estimands</em>, other unknown values.</p>
<p>One key aspect of this Preceptor Table is whether or not we need more than one potential outcome in order to calculate our estimand. For example, if we want to know the causal effect of exposure to Spanish-speakers on attitude toward immigration then we need a causal model, one which estimates that attitude for each person under both treatment and control. The Preceptor Table would require two columns for the outcome. If, on the other hand, we only want to predict someone’s attitude, or compare one person’s attitude to another’s, then we would only need a Preceptor Table with one column for the outcome.</p>
<p>Are we are modeling (just) for prediction or are we (also) modeling for causation? Predictive models care nothing about causation. Causal models are often also concerned with prediction, if only as a means of measuring the quality of the model.</p>
<p>Every model is predictive, in the sense that, if we give you new data — and it is drawn from the same population — then you can create a predictive forecast. But only a subset of those models are causal, meaning that, <em>for a given individual</em>, you can change the value of one input and figure out what the new output would be and then, from that, calculate the causal effect by looking at the difference between two potential outcomes.</p>
<p>With prediction, all we care about is forecasting <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span> on some as-yet-unseen data. But there is no notion of “manipulation” in such models. We don’t pretend that, for Joe, we could turn variable <span class="math inline">\(X\)</span> from a value of <span class="math inline">\(5\)</span> to a value of <span class="math inline">\(6\)</span> by just turning some knob and, by doing so, cause Joe’s value of <span class="math inline">\(Y\)</span> to change from <span class="math inline">\(17\)</span> to <span class="math inline">\(23\)</span>. We can compare two people (or two groups of people), one with <span class="math inline">\(X\)</span> equal to <span class="math inline">\(5\)</span> and one with <span class="math inline">\(X\)</span> equal to <span class="math inline">\(6\)</span>, and see how they differ in <span class="math inline">\(Y\)</span>. The basic assumption of predictive models is that there is only one possible <span class="math inline">\(Y\)</span> for Joe. There are not, by assumption, two possible values for <span class="math inline">\(Y\)</span>, one if <span class="math inline">\(X\)</span> equals <span class="math inline">\(5\)</span> and another if <span class="math inline">\(X\)</span> equals <span class="math inline">\(6\)</span>. The Preceptor Table has a single column under <span class="math inline">\(Y\)</span>.</p>
<p>With causal inference, however, we can consider the case of Joe with <span class="math inline">\(X = 5\)</span> and Joe with <span class="math inline">\(X = 6\)</span>. The same mathematical model can be used. And both models can be used for prediction, for estimating what the value of <span class="math inline">\(Y\)</span> will be for a yet-unseen observation with a specified value for <span class="math inline">\(X\)</span>. But, in this case, instead of only a single column in the Preceptor Table for <span class="math inline">\(Y\)</span>, we have at least two (and possibly many) such columns, one for each of the potential outcomes under consideration.</p>
<p><em>The difference between prediction models and causal models is that the former have one column for the outcome variable and the latter have more than one column.</em></p>
<p>Second, we look at the data we have and perform an <strong>e</strong>xploratory <strong>d</strong>ata <strong>a</strong>nalysis, an EDA. You can never look at your data too much. The most important variable is the one we most want to understand/explain/predict. In the models we create in later chapters, this variable will go on the left-hand side of our mathematical equations. Some academic fields refer to this as the “dependent variable.” Others use terms like “response” or “outcome.” Whatever the terminology, we need to explore the distribution of this variable, its min/max/range, its mean and median, its standard deviation, and so on.</p>
<p><span class="citation" data-cites="roas">Gelman, Hill, and Vehtari (<a href="references.html#ref-roas" role="doc-biblioref">2020</a>)</span> write:</p>
<blockquote class="blockquote">
<p>Most important is that the data you are analyzing should map to the research question you are trying to answer. This sounds obvious but is often overlooked or ignored because it can be inconvenient. Optimally, this means that the outcome measure should accurately reflect the phenomenon of interest, the model should include all relevant predictors, and the model should generalize to the cases to which it will be applied.</p>
</blockquote>
<blockquote class="blockquote">
<p>For example, with regard to the outcome variable, a model of incomes will not necessarily tell you about patterns of total assets. A model of test scores will not necessarily tell you about child intelligence or cognitive development. …</p>
</blockquote>
<p>We care about other variables as well, especially those that are most correlated/connected with the outcome variable. The more time that we spend looking at these variables, the more likely we are to create a useful model.</p>
<p>Third, the (almost always imaginary) <em>population</em> is key. We need the data we <em>want</em> — the Preceptor Table — and the data we <em>have</em> to be similar enough that we can consider them as all having come from the same statistical population. From <a href="https://en.wikipedia.org/wiki/Statistical_population">Wikipedia</a>:</p>
<blockquote class="blockquote">
<p>In statistics, a population is a set of similar items or events which is of interest for some question or experiment. A statistical population can be a group of existing objects (e.g.&nbsp;the set of all stars within the Milky Way galaxy) or a hypothetical and potentially infinite group of objects conceived as a generalization from experience (e.g.&nbsp;the set of all opening hands in all the poker games in Las Vegas tomorrow).</p>
</blockquote>
<p>Mechanically, assuming that the Precetor Table and the data are drawn from the same population is the same thing as “stacking” the two on top of each other. For that to make sense, the variables must mean the same thing — at least mostly — in both sources. This is the assumption of <em>validity</em>. For example, if the Preceptor Table concerns who people will vote for in the election next week and the data is from a survey taken last week, it is not obvious that we can consider the data as coming from the same population. After all, voting and survey responses are not exactly the same thing. We can only assume that they are — which is precisely what everyone who forecasts elections does — if we assume that both are “valid” measures of the same underlying construct.</p>
<p>If we assume that the data we have is drawn from the same population as the data in the Preceptor Table, then we can use information about the former to make inferences about the latter. We can combine the Preceptor Table and the data into a single <em>Population Table</em>. If we can’t do that, if we can’t assume that the two sources come from the same population, then we can’t use our data to answer our questions. We have no choice but to walk away. The heart of Wisdom is knowing when to walk away. As John Tukey noted:</p>
<blockquote class="blockquote">
<p>The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.</p>
</blockquote>
</section>
<section id="justice" class="level3" data-number="2.8.2">
<h3 data-number="2.8.2" class="anchored" data-anchor-id="justice"><span class="header-section-number">2.8.2</span> Justice</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="other/images/Justice.jpg" class="img-fluid figure-img" width="960"></p>
<figcaption class="figure-caption">Justice.</figcaption>
</figure>
</div>
</div>
</div>
<p>After Wisdom, we have an <em>Population Table.</em> It includes rows for the data we have and the data we want to have. It will almost always have many more rows, rows from the larger population of which the Preceptor Table and our data form a portion. It has missing values, most importantly for potential outcomes which were not observed. The central problem in inference is to fill in the question marks in the Population Table.</p>
<p>There are three key issues to explore in any Population Table: stability, representativeness and unconfoundedness.</p>
<ul>
<li><p><em>Stability</em> assumes that the relationship between the outcome variable and the covariates is consistent over time. Never forget that <em>temporal</em> nature of almost all real data science problems. Our Preceptor Table will focus on rows for today or for the near future. <em>The data we have will always be from before now.</em> We must almost always assume that the future will be like the past in order to use data from the past to make predictions about the future.</p></li>
<li><p><em>Representativeness</em> is a two-sided concern. We want the data we have to be representative of the population for which we need to calculate parameters. Ideally, we would love for our data to be randomly sampled from the population, but this is almost never the case. But this is a concern, not just with our data, but also for our Preceptor Table. If the data we want is not representative of the entire population then we will need to be careful in the inferences which we draw.</p></li>
</ul>
<!-- DK: Flesh the above out a bit. Is representativeness really a, exactly, two-sided concern. If so, we should treat each part separately each time we deal with it. -->
<p><em>Validity is about the columns in our Population Table. Stability and representativeness are about the rows.</em></p>
<p>The last step of Justice is to make an assumption about the structure of the data generating mechanism (DGM): the mathematical formula, and associated error term, which relates our outcome variable to our covariates.</p>
<p><em>Justice requires math.</em> Consider a model of coin-tossing:</p>
<p><span class="math display">\[ H_i  \sim B(\rho_h, n = 20) \]</span></p>
<p>The total number <span class="math inline">\(H\)</span> of Heads in experiment <span class="math inline">\(i\)</span> with 20 flips of a single coin, <span class="math inline">\(H_i\)</span>, is distributed as a binomial with <span class="math inline">\(n = 20\)</span> and an unknown probability <span class="math inline">\(\rho_h\)</span> of the coin coming up Heads.</p>
<p>Note:</p>
<ul>
<li><p>This is a cheat and a simplification! We are Bayesians but we have not specified the full Bayesian machinery. We really need priors on the unknown parameter <span class="math inline">\(\rho_h\)</span> as well. But that is too complex for an introductory textbook, so we wave our hands, accept the default sensible parameters built into the R packages we use, and point readers to more advanced books, like <span class="citation" data-cites="roas">Gelman, Hill, and Vehtari (<a href="references.html#ref-roas" role="doc-biblioref">2020</a>)</span>.</p></li>
<li><p>Defining <span class="math inline">\(\rho_h\)</span> as the “the probability that the coin comes up Heads” is a bit of a fudge. If you calculate that by hand and then compare it to what our tools produce, they won’t be the same. Instead, the calculated value will be closer to zero. Why? <span class="math inline">\(\rho_h\)</span> is really the “long-run percentage of the time the coin comes up Heads.” It is not just the percentage from this experiment.</p></li>
</ul>
<!-- DK: Unclear, even to me! -->
<ul>
<li>In this simple case, we are fortunate that the parameter <span class="math inline">\(\rho_h\)</span> has such a (mostly!) simple analog to a real world quantity. Most of the time, parameters are not so easy to interpret. In a more complex model, especially those with interaction terms, we focus less on parameters and more on actual predictions.</li>
</ul>
</section>
<section id="courage" class="level3" data-number="2.8.3">
<h3 data-number="2.8.3" class="anchored" data-anchor-id="courage"><span class="header-section-number">2.8.3</span> Courage</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="other/images/Courage.jpg" class="img-fluid figure-img" width="1024"></p>
<figcaption class="figure-caption">Courage.</figcaption>
</figure>
</div>
</div>
</div>

<!-- Courage: For each model, write down the math, estimate the model, say something sensible about the regression table. Testing is stupid. -->
<p><em>The three languages of data science are words, math and code, and the most important of these is code.</em></p>
<p>We need to explain the structure of our model using all three languages, but we need <em>Courage</em> to implement the model in code.</p>
<p>Courage requires us to take the general mathematical formula provide by Justice and then make it specific. Which variables should we include in the model and which do we exclude? Every data science project involves the creation of several models. For each, we specify the precise data generating mechanism. Using that formula, and some R code, we create a fitted model. All models have parameters. We can never know the true values of the parameters, but we can create, and explore, posterior distributions for those unknown true values.</p>
<!-- Above is awk. -->
<p>Code allows us to “fit” a model by estimating the values of the unknown parameters, like <span class="math inline">\(\rho_h\)</span>. Sadly, we can never know the true values of these parameters. But, like all good statisticians, we can express our uncertain knowledge in the form of posterior probability distributions. With those distributions, we can compare the actual values of the outcome variable with the “fitted” or “predicted” results of the model. We can examine the “residuals,” the difference between the fitted and actual values.</p>
<p>Every outcome is the sum of two parts: the model and what is not in the model:</p>
<p><span class="math display">\[outcome = model + what\ is\ not\ in\ the\ model\]</span></p>
<p>It doesn’t matter what the outcome is. It could be the result of a coin flip, the weight of a person, the GDP of a country. Whatever <em>outcome</em> we are considering is always made up of two parts. The first is the model we have created. The second is all the stuff — all the blooming and buzzing complexity of the real world — which is not a part of the model.</p>
<p>Some of our uncertainty is driven by our ignorance about <span class="math inline">\(\rho_h\)</span>.</p>
<p>A parameter is something which does not exist in the real world. (If it did, or could, then it would be data.) Instead, a parameter is a mental abstraction, a building block which we will use to to help us accomplish our true goal: To replace at least some of the questions marks in the actual Preceptor Table. Since parameters are mental abstractions, we will always be uncertain as to their value, however much data we might collect.</p>
<p>But some, often most, of the uncertainty comes from forces that are, by assumption, not in the model. For example, if the coin is fair, we expect <span class="math inline">\(H_i\)</span> to equal 10. But, often, it will be different, even if we are correct and <span class="math inline">\(\rho_h\)</span> equals exactly 0.5.</p>
<p><em>Randomness is intrinsic to this fallen world.</em></p>
</section>
<section id="temperance" class="level3" data-number="2.8.4">
<h3 data-number="2.8.4" class="anchored" data-anchor-id="temperance"><span class="header-section-number">2.8.4</span> Temperance</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="other/images/Temperance.jpg" class="img-fluid figure-img" width="960"></p>
<figcaption class="figure-caption">Temperance.</figcaption>
</figure>
</div>
</div>
</div>
<!-- Temperance. Answer the question. Create a newobs, plug it into the model, calculate the outcome. Don't forget to add the error term if you are predicting. Then plot it. Be aware of the limits to the accuracy of your answer. Preceptor's Posterior.  All the cool themes. Bring it all together. Make the students say "Ahhh!" -->
<!-- Perhaps at least mention decision analysis. -->
<p>There are few more important concepts in statistics and data science than the “Data Generating Mechanism.” Our <em>data</em> — the data that we collect and see — has been <em>generated</em> by the complexity and confusion of the world. God’s own <em>mechanism</em> has brought His data to us. Our job is to build a model of that process, to create, on the computer, a mechanism which generates fake data consistent with the data which we see. With that DGM, we can answer any question which we might have. In particular, with the DGM, we provide predictions of data we have not seen and estimates of the uncertainty associated with those predictions.</p>
<p><em>Justice</em> gave us the structure of the DGM. <em>Courage</em> created the DGM, the fitted model. <em>Temperance</em> will guide us in its use.</p>
<p>Having created (and checked) a model, we now use the model to answer questions. Models are made for use, not for beauty. The world confronts us. Make decisions we must. Our decisions will be better ones if we use high quality models to help make them.</p>
<p>Sadly, our models are never as good as we would like them to be. First, the world is intrinsically uncertain.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-probability/images/donald_rumsfeld.jpg" class="img-fluid figure-img" width="600"></p>
<figcaption class="figure-caption">Donald Rumsfeld.</figcaption>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>There are known knowns. There are things we know we know. We also know there are known unknowns. That is to say, we know there are some things we do not know. But there are also unknown unknowns, the ones we do not know we do not know. – Donald Rumsfeld</p>
</blockquote>
<p>What we really care about is data we haven’t seen yet, mostly data from tomorrow. But what if the world changes, as it always does? If it doesn’t change much, maybe we are OK. If it changes a lot, then what good will our model be? In general, the world changes some. That means that <em>our forecasts are more uncertain that a naive use of our model might suggest.</em></p>
<p>We need temperance in order to study and understand the unknown unknowns in our model. Temperance is also important when we analyze the “realism” of our models. When we created the mathematical probability distribution for presidential elections, for instance, we assumed that the Democratic candidate would have a 50% chance of winning each vote in the electoral college. By comparing the mathematical model to our empirical cases, however, we recognize that the mathematical model is unlikely to be true. The mathematical model suggested that getting fewer than 100 votes is next to impossible, but many past Democratic candidates in the empirical distribution received less than 100 electoral votes.</p>
<p>In Temperance, the key distinction is between the <em>true</em> posterior distribution — what we will call “Preceptor’s Posterior” — and the estimated posterior distribution. Recall our discussion from <a href="#sec-distributions"><span>Section&nbsp;2.1</span></a>. Imagine that every assumption we made in Wisdom and Justice were correct, that we correctly understand every aspect of how the world works. We still would not know the unknown value we are trying to estimate — recall the Fundamental Problem of Causal Inference — but the posterior we created would be perfect. That is Preceptor’s Posterior. Sadly, even if our estimated posterior is, very close to Preceptor’s Posterior, we can never be sure of that fact, because we can never know the truth, never be certain that all the assumptions we made are correct.</p>
<p>Even worse, we must always worry that our estimated posterior, despite all the work we put into creating it, is far from the truth. We, therefore, must be cautious in our use of that posterior, humble in our claims about its accuracy. Using our posterior, despite its faults, is better than not using it. Yet it is, as best, a distorted map of reality, a glass through which we must look darkly. Use your posteriors with humility.</p>
<!-- DK: Could do more here. Show the iterative process of model building, including posterior predictive checks. -->
<!-- Null hypothesis testing is a mistake. There is only the data, the models and the summaries therefrom. Describe an hypothesis test each chapter, and then dismiss it. Play the prediction game. That, perhaps, provides a useful framework for why NHST is stupid. Or, rather, you play the prediction game to figure out which statistical procedures are best --- and or, how well procedure X works --- and then use that information to make a decision. Explain what a test is, and why we think it is a waste of time to do them, and why people do them anyway. Key issue: If p = 0.04 really makes you do something totally different than p = 0.06, then either you (or the system within which you are operating) is stupid. -->
</section>
</section>
<section id="summary" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="summary"><span class="header-section-number">2.9</span> Summary</h2>
<!-- DK: Not a bad summary, but should hit the key points more clearly.  -->
<p>Throughout this Chapter, we spent time going through examples of conditional distributions. However, it’s worth noting that all probability distributions are conditional on something. Even in the most simple examples, when we were flipping a coin multiple times, we were assuming that the probability of getting heads versus tails did not change between tosses.</p>
<p>We discussed the difference between empirical, mathematical, and posterior probability distributions. Even though we developed these heuristics to better understand distributions, every time we make a claim about the world, it is based on our beliefs - what we think about the world. We could be wrong. Two reasonable people can have conflicting beliefs about the fairness of a coin.</p>
<p>It is useful to understand the three types of distributions and the concept of conditional distributions, but almost every probability distribution is conditional and posterior. We can leave out both words in future discussions, as we generally will in this book. They are implicit.</p>
<p>If you are keen to learn more about probability, here is a video featuring Professor Gary King. This is a great way to review some of the concepts we covered in this chapter, albeit at a higher level of mathematics.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/6C7yRBfh2ok" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<!-- ```{r, echo = FALSE, fig.cap = "The truth is out there"} -->
<!-- knitr::include_graphics("05-probability/images/truth_out_there.jpg") -->
<!-- ``` -->
<!-- * *The truth is out there.* The next adult American male we meet will have a height. Right now, we don't know what it is.  -->
<!-- Notes from DeGroot Probability and Statistics and from Freund Mathemathical Statistics.  -->
<!-- Not sure how useful these are or how to incorporate them, but wanted to keep them around. -->
<!-- A random variable is a function which generates the value of an unknown variable. -->
<!-- A probability function is a set function which maps outcomes to probabilities. -->
<!-- The value of a random variable is a function of a chance experiment. -->
<!-- Probabilities are values of a set function. -->
<!-- Random variables are capital letters, like X, while real values are small letters, like x. -->
<!-- X = x is the set of elements in the sample space for which the random variable X takes on the vaklue x. -->

<!-- Freund (p. 86): Give a table and then give a formula which creates the table. That formula is the probability distribution of X. Example: -->
<!-- x     P(X = x) -->
<!-- 2       1/36 -->
<!-- 3       2/36 -->
<!-- ...     ... -->
<!-- 7       6/36 -->
<!-- ...     ... -->
<!-- 12      1/36 -->
<!-- An event or experiment os any process wh0se outcome is not known with certainty. -->
<!-- The sample space is all possible outcomes of the event. -->
<!-- DeGroot (p. 97): "Consider an experiment for which the sample space us denoted by S. A real-valued function that is defined on the space S is called a random variable. In other words, in a particular experiment a random variable X would be some function that assigns a real number X(s) to each possible outcome s \subset S. -->


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-roas" class="csl-entry" role="listitem">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Analytical Methods for Social Research. Cambridge University Press. <a href="https://doi.org/10.1017/9781139161879">https://doi.org/10.1017/9781139161879</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-rubin-causal-model.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Rubin Causal Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-one-parameter.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">One Parameter</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>